<!DOCTYPE html>


<!--
 | Generated by Apache Maven Doxia Site Renderer 2.0.0-M13 from src/site/markdown/userguide/server-configuration.md at 2024-11-02
 | Rendered using Apache Maven Fluido Skin 2.0.0-M8
-->
<html xmlns="http://www.w3.org/1999/xhtml" lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="generator" content="Apache Maven Doxia Site Renderer 2.0.0-M13" />
    <title>Jargyle â€“ Server Configuration</title>
    <link rel="stylesheet" href="../css/apache-maven-fluido-2.0.0-M8.min.css" />
    <link rel="stylesheet" href="../css/site.css" />
    <link rel="stylesheet" href="../css/print.css" media="print" />
    <script src="../js/apache-maven-fluido-2.0.0-M8.min.js"></script>
<link rel="stylesheet" href="./css/default.min.css">
<script src="./js/highlight.min.js"></script>
<script>hljs.highlightAll();</script>
  </head>
  <body>
    <div class="container-fluid container-fluid-top">
      <header>
        <div id="banner">
          <div class="pull-left"></div>
          <div class="pull-right"></div>
          <div class="clear"><hr/></div>
        </div>

        <div id="breadcrumbs">
          <ul class="breadcrumb">
        <li id="publishDate">Last Published: 2024-11-02<span class="divider">|</span>
</li>
          <li id="projectVersion">Version: 5.0.0-SNAPSHOT</li>
          </ul>
        </div>
      </header>
      <div class="row-fluid">
        <header id="leftColumn" class="span2">
          <nav class="well sidebar-nav">
  <ul class="nav nav-list">
   <li class="nav-header">Overview</li>
    <li><a href="../index.html">Introduction</a></li>
    <li><a href="../licenses.html">Licenses</a></li>
    <li><a href="../releases.html">Releases</a></li>
   <li class="nav-header">User Guide</li>
    <li><a href="../userguide/client-api.html">Client API</a></li>
    <li><a href="../userguide/client-configuration.html">Client Configuration</a></li>
    <li><a href="../userguide/cli.html">Command Line Interface</a></li>
    <li><a href="../userguide/server-api.html">Server API</a></li>
    <li class="active"><a>Server Configuration</a></li>
   <li class="nav-header">Reference</li>
    <li><a href="../reference/client-properties.html">Client Properties</a></li>
    <li><a href="../reference/cli-help-info.html">Command Line Interface Help Information</a></li>
    <li><a href="../reference/rule-actions.html">Rule Actions</a></li>
    <li><a href="../reference/rule-conditions.html">Rule Conditions</a></li>
    <li><a href="../reference/server-configuration-file-schema.html">Server Configuration File Schema</a></li>
    <li><a href="../reference/server-configuration-settings.html">Server Configuration Settings</a></li>
    <li><a href="../reference/socks5-resolve-request.html">SOCKS5 RESOLVE Request</a></li>
    <li><a href="../reference/value-syntaxes.html">Value Syntaxes</a></li>
   <li class="nav-header">API Documentation</li>
    <li><a href="../apidocs/index.html">Javadoc</a></li>
   <li class="nav-header">Project Documentation</li>
    <li><a href="../project-info.html"><span class="icon-chevron-right"></span>Project Information</a></li>
    <li><a href="../project-reports.html"><span class="icon-chevron-right"></span>Project Reports</a></li>
   <li class="nav-header">Modules</li>
    <li><a href="../jargyle-client/index.html">Jargyle Client</a></li>
    <li><a href="../jargyle-common/index.html">Jargyle Common</a></li>
    <li><a href="../jargyle-internal/index.html">Jargyle Internal</a></li>
    <li><a href="../jargyle-protocolbase/index.html">Jargyle Protocolbase</a></li>
    <li><a href="../jargyle-server/index.html">Jargyle Server</a></li>
  </ul>
          </nav>
          <div class="well sidebar-nav">
            <div id="poweredBy">
              <div class="clear"></div>
              <div class="clear"></div>
              <div class="clear"></div>
<a href="https://maven.apache.org/" class="builtBy" target="_blank"><img class="builtBy" alt="Built by Maven" src="../images/logos/maven-feather.png" /></a>
            </div>
          </div>
        </header>
        <main id="bodyColumn" class="span10">
<section>
<h1>Server Configuration</h1>
<p>The following are topics for configuring the server from the server API and from
the command line.</p><section>
<h2>Page Contents</h2>
<ul>

<li><a href="#enabling-ssltls-for-tcp-traffic-between-the-server-and-its-clients">Enabling SSL/TLS for TCP Traffic Between the Server and Its Clients</a></li>
<li><a href="#enabling-dtls-for-udp-traffic-between-the-server-and-its-clients">Enabling DTLS for UDP Traffic Between the Server and Its Clients</a></li>
<li><a href="#using-socks5-authentication">Using SOCKS5 Authentication</a>
<ul>

<li><a href="#using-no-authentication">Using No Authentication</a></li>
<li><a href="#using-username-password-authentication">Using Username Password Authentication</a></li>
<li><a href="#using-gss-api-authentication">Using GSS-API Authentication</a></li>
</ul></li>
<li><a href="#chaining-to-another-socks-server">Chaining to Another SOCKS Server</a>
<ul>

<li><a href="#enabling-ssltls-for-tcp-traffic-between-the-server-and-the-other-socks-server">Enabling SSL/TLS for TCP Traffic Between the Server and the Other SOCKS Server</a></li>
<li><a href="#enabling-dtls-for-udp-traffic-between-the-server-and-the-other-socks-server">Enabling DTLS for UDP Traffic Between the Server and the Other SOCKS Server</a></li>
<li><a href="#chaining-to-the-other-socks-server-using-socks5-authentication">Chaining to the Other SOCKS Server Using SOCKS5 Authentication</a>
<ul>

<li><a href="#chaining-to-the-other-socks-server-using-no-authentication">Chaining to the Other SOCKS Server Using No Authentication</a></li>
<li><a href="#chaining-to-the-other-socks-server-using-username-password-authentication">Chaining to the Other SOCKS Server Using Username Password Authentication</a></li>
<li><a href="#chaining-to-the-other-socks-server-using-gss-api-authentication">Chaining to the Other SOCKS Server Using GSS-API Authentication</a></li>
</ul></li>
<li><a href="#resolving-host-names-from-the-other-socks5-server">Resolving Host Names From the Other SOCKS5 Server</a></li>
</ul></li>
<li><a href="#chaining-to-a-specified-chain-of-other-socks-servers">Chaining to a Specified Chain of Other SOCKS Servers</a></li>
<li><a href="#chaining-to-specified-chains-of-other-socks-servers">Chaining to Specified Chains of Other SOCKS Servers</a></li>
<li><a href="#using-rules-to-manage-traffic">Using Rules to Manage Traffic</a>
<ul>

<li><a href="#rule-conditions">Rule Conditions</a></li>
<li><a href="#rule-actions">Rule Actions</a></li>
<li><a href="#allowing-or-denying-traffic">Allowing or Denying Traffic</a></li>
<li><a href="#allowing-a-limited-number-of-simultaneous-instances-of-traffic">Allowing a Limited Number of Simultaneous Instances of Traffic</a></li>
<li><a href="#routing-traffic-through-a-selection-of-specified-chains-of-socks-servers">Routing Traffic Through a Selection of Specified Chains of SOCKS Servers</a></li>
<li><a href="#redirecting-the-desired-destination">Redirecting the Desired Destination</a></li>
<li><a href="#configuring-sockets">Configuring Sockets</a></li>
<li><a href="#configuring-relay-settings">Configuring Relay Settings</a></li>
<li><a href="#limiting-relay-bandwidth">Limiting Relay Bandwidth</a></li>
</ul></li>
</ul>
<p><a id="enabling-ssltls-for-tcp-traffic-between-the-server-and-its-clients"></a></p></section><section>
<h2>Enabling SSL/TLS for TCP Traffic Between the Server and Its Clients</h2>
<p>You can enable SSL/TLS for TCP traffic between the server and its clients. By
default, SSL/TLS for TCP traffic between the server and its clients is disabled.
To enable SSL/TLS for TCP traffic between the server and its clients, you will
need to have the setting <code>ssl.enabled</code> set to <code>true</code>. In addition, you will
need to have the setting <code>ssl.keyStoreFile</code> to specify the server's key store
file (this file would need to be created by Java's keytool utility). Also, you
will need to have the setting <code>ssl.keyStorePassword</code> to specify the password
for the server's key store file.</p>
<p>API example:</p>

<div class="verbatim">
<pre><code class="language-java">package com.example;

import com.github.jh3nd3rs0n.jargyle.server.Configuration;
import com.github.jh3nd3rs0n.jargyle.server.Setting;
import com.github.jh3nd3rs0n.jargyle.server.Settings;
import com.github.jh3nd3rs0n.jargyle.server.SocksServer;

import java.io.IOException;

public class ServerApp {
    public static void main(String[] args) throws IOException {
        new SocksServer(Configuration.newUnmodifiableInstance(Settings.of(
            Setting.newInstanceWithParsedValue(
                &quot;ssl.enabled&quot;, &quot;true&quot;),
            Setting.newInstanceWithParsedValue(
                &quot;ssl.keyStoreFile&quot;, &quot;server.jks&quot;),
            Setting.newInstanceWithParsedValue(
                &quot;ssl.keyStorePassword&quot;, &quot;password&quot;)
        ))).start();
    }
}
</code></pre></div>
<p>Command line example:</p>

<div class="verbatim">
<pre><code class="language-bash">jargyle start-server \
    --setting=ssl.enabled=true \
    --setting=ssl.keyStoreFile=server.jks \
    --setting=ssl.keyStorePassword=password
</code></pre></div>
<p>Server configuration file example:</p>

<div class="verbatim">
<pre><code class="language-xml">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot; standalone=&quot;yes&quot;?&gt;
&lt;configuration&gt;
    &lt;settings&gt;
        &lt;setting&gt;
            &lt;name&gt;ssl.enabled&lt;/name&gt;
            &lt;value&gt;true&lt;/value&gt;
        &lt;/setting&gt;
        &lt;setting&gt;
            &lt;name&gt;ssl.keyStoreFile&lt;/name&gt;
            &lt;value&gt;server.jks&lt;/value&gt;
        &lt;/setting&gt;
        &lt;setting&gt;
            &lt;name&gt;ssl.keyStorePassword&lt;/name&gt;
            &lt;value&gt;password&lt;/value&gt;
            &lt;doc&gt;If this configuration file was created by new-server-config-file, the password would be encrypted&lt;/doc&gt;
        &lt;/setting&gt;
    &lt;/settings&gt;
&lt;/configuration&gt;
</code></pre></div>
<p>If you do not want to have the password appear in any script or in any part of
the command line history for security reasons, you can use the command line
option <code>--enter-ssl-key-store-pass</code> instead. It will provide an interactive
prompt for you to enter the password.</p>
<p>Command line example:</p>

<div class="verbatim">
<pre><code class="language-bash">jargyle start-server \
    --setting=ssl.enabled=true \
    --setting=ssl.keyStoreFile=server.jks \
    --enter-ssl-key-store-pass
</code></pre></div>
<p>If you want to have the client authenticate using SSL/TLS, you will need to have
the setting <code>ssl.needClientAuth</code> set to <code>true</code>. In addition, you will need
to have the setting <code>ssl.trustStoreFile</code> to specify the client's key store
file to be used as a trust store (this file would need to be created by Java's
keytool utility). Also, you will need to have the setting
<code>ssl.trustStorePassword</code> to specify the password for the client's trust
store file.</p>
<p>API example:</p>

<div class="verbatim">
<pre><code class="language-java">package com.example;

import com.github.jh3nd3rs0n.jargyle.server.Configuration;
import com.github.jh3nd3rs0n.jargyle.server.Setting;
import com.github.jh3nd3rs0n.jargyle.server.Settings;
import com.github.jh3nd3rs0n.jargyle.server.SocksServer;

import java.io.IOException;

public class ServerApp {
    public static void main(String[] args) throws IOException {
        new SocksServer(Configuration.newUnmodifiableInstance(Settings.of(
            Setting.newInstanceWithParsedValue(
                &quot;ssl.enabled&quot;, &quot;true&quot;),
            Setting.newInstanceWithParsedValue(
                &quot;ssl.keyStoreFile&quot;, &quot;server.jks&quot;),
            Setting.newInstanceWithParsedValue(
                &quot;ssl.keyStorePassword&quot;, &quot;password&quot;),
            Setting.newInstanceWithParsedValue(
                &quot;ssl.needClientAuth&quot;, &quot;true&quot;),
            Setting.newInstanceWithParsedValue(
                &quot;ssl.trustStoreFile&quot;, &quot;client.jks&quot;),
            Setting.newInstanceWithParsedValue(
                &quot;ssl.trustStorePassword&quot;, &quot;drowssap&quot;)
        ))).start();
    }
}
</code></pre></div>
<p>Command line example:</p>

<div class="verbatim">
<pre><code class="language-bash">jargyle start-server \
    --setting=ssl.enabled=true \
    --setting=ssl.keyStoreFile=server.jks \
    --setting=ssl.keyStorePassword=password \
    --setting=ssl.needClientAuth=true \
    --setting=ssl.trustStoreFile=client.jks \
    --setting=ssl.trustStorePassword=drowssap
</code></pre></div>
<p>Server configuration file example:</p>

<div class="verbatim">
<pre><code class="language-xml">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot; standalone=&quot;yes&quot;?&gt;
&lt;configuration&gt;
    &lt;settings&gt;
        &lt;setting&gt;
            &lt;name&gt;ssl.enabled&lt;/name&gt;
            &lt;value&gt;true&lt;/value&gt;
        &lt;/setting&gt;
        &lt;setting&gt;
            &lt;name&gt;ssl.keyStoreFile&lt;/name&gt;
            &lt;value&gt;server.jks&lt;/value&gt;
        &lt;/setting&gt;
        &lt;setting&gt;
            &lt;name&gt;ssl.keyStorePassword&lt;/name&gt;
            &lt;value&gt;password&lt;/value&gt;
            &lt;doc&gt;If this configuration file was created by new-server-config-file, the password would be encrypted&lt;/doc&gt;
        &lt;/setting&gt;
        &lt;setting&gt;
            &lt;name&gt;ssl.needClientAuth&lt;/name&gt;
            &lt;value&gt;true&lt;/value&gt;
        &lt;/setting&gt;
        &lt;setting&gt;
            &lt;name&gt;ssl.trustStoreFile&lt;/name&gt;
            &lt;value&gt;client.jks&lt;/value&gt;
        &lt;/setting&gt;
        &lt;setting&gt;
            &lt;name&gt;ssl.trustStorePassword&lt;/name&gt;
            &lt;value&gt;drowssap&lt;/value&gt;
            &lt;doc&gt;If this configuration file was created by new-server-config-file, the password would be encrypted&lt;/doc&gt;
        &lt;/setting&gt;
    &lt;/settings&gt;
&lt;/configuration&gt;
</code></pre></div>
<p>If you do not want to have the password appear in any script or in any part of
the command line history for security reasons, you can use the command line
option <code>--enter-ssl-trust-store-pass</code> instead. It will provide an
interactive prompt for you to enter the password.</p>
<p>Command line example:</p>

<div class="verbatim">
<pre><code class="language-bash">jargyle start-server \
    --setting=ssl.enabled=true \
    --setting=ssl.keyStoreFile=server.jks \
    --enter-ssl-key-store-pass \
    --setting=ssl.needClientAuth=true \
    --setting=ssl.trustStoreFile=client.jks \
    --enter-ssl-trust-store-pass
</code></pre></div></section><section>
<h2>Enabling DTLS for UDP Traffic Between the Server and Its Clients</h2>
<p>You can enable DTLS for UDP traffic between the server and its clients. By
default, DTLS for UDP traffic between the server and its clients is disabled. To
enable DTLS for UDP traffic between the server and its clients, you will need to
have the setting <code>dtls.enabled</code> set to <code>true</code>. In addition, you will need to
have the setting <code>dtls.keyStoreFile</code> to specify the server's key store file
(this file would need to be created by Java's keytool utility). Also, you will
need to have the setting <code>dtls.keyStorePassword</code> to specify the password for
the server's key store file.</p>
<p>API example:</p>

<div class="verbatim">
<pre><code class="language-java">package com.example;

import com.github.jh3nd3rs0n.jargyle.server.Configuration;
import com.github.jh3nd3rs0n.jargyle.server.Setting;
import com.github.jh3nd3rs0n.jargyle.server.Settings;
import com.github.jh3nd3rs0n.jargyle.server.SocksServer;

import java.io.IOException;

public class ServerApp {
    public static void main(String[] args) throws IOException {
        new SocksServer(Configuration.newUnmodifiableInstance(Settings.of(
            Setting.newInstanceWithParsedValue(
                &quot;dtls.enabled&quot;, &quot;true&quot;),
            Setting.newInstanceWithParsedValue(
                &quot;dtls.keyStoreFile&quot;, &quot;server.jks&quot;),
            Setting.newInstanceWithParsedValue(
                &quot;dtls.keyStorePassword&quot;, &quot;password&quot;)
        ))).start();
    }
}
</code></pre></div>
<p>Command line example:</p>

<div class="verbatim">
<pre><code class="language-bash">jargyle start-server \
    --setting=dtls.enabled=true \
    --setting=dtls.keyStoreFile=server.jks \
    --setting=dtls.keyStorePassword=password
</code></pre></div>
<p>Server configuration file example:</p>

<div class="verbatim">
<pre><code class="language-xml">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot; standalone=&quot;yes&quot;?&gt;
&lt;configuration&gt;
    &lt;settings&gt;
        &lt;setting&gt;
            &lt;name&gt;dtls.enabled&lt;/name&gt;
            &lt;value&gt;true&lt;/value&gt;
        &lt;/setting&gt;
        &lt;setting&gt;
            &lt;name&gt;dtls.keyStoreFile&lt;/name&gt;
            &lt;value&gt;server.jks&lt;/value&gt;
        &lt;/setting&gt;
        &lt;setting&gt;
            &lt;name&gt;dtls.keyStorePassword&lt;/name&gt;
            &lt;value&gt;password&lt;/value&gt;
            &lt;doc&gt;If this configuration file was created by new-server-config-file, the password would be encrypted&lt;/doc&gt;
        &lt;/setting&gt;
    &lt;/settings&gt;
&lt;/configuration&gt;
</code></pre></div>
<p>If you do not want to have the password appear in any script or in any part of
the command line history for security reasons, you can use the command line
option <code>--enter-dtls-key-store-pass</code> instead. It will provide an
interactive prompt for you to enter the password.</p>
<p>Command line example:</p>

<div class="verbatim">
<pre><code class="language-bash">jargyle start-server \
    --setting=dtls.enabled=true \
    --setting=dtls.keyStoreFile=server.jks \
    --enter-dtls-key-store-pass
</code></pre></div></section><section>
<h2>Using SOCKS5 Authentication</h2>
<p>The server has the following SOCKS5 authentication methods to choose from:</p>
<ul>

<li><code>NO_AUTHENTICATION_REQUIRED</code>: No authentication required</li>
<li><code>GSSAPI</code>: GSS-API authentication</li>
<li><code>USERNAME_PASSWORD</code>: Username password authentication</li>
</ul>
<p>From the API and from the command line, you can have one or more of the
aforementioned authentication methods set in the setting <code>socks5.methods</code> as
a comma separated list.</p>
<p>API example:</p>

<div class="verbatim">
<pre><code class="language-java">package com.example;

import com.github.jh3nd3rs0n.jargyle.server.Configuration;
import com.github.jh3nd3rs0n.jargyle.server.Setting;
import com.github.jh3nd3rs0n.jargyle.server.Settings;
import com.github.jh3nd3rs0n.jargyle.server.SocksServer;

import java.io.IOException;

public class ServerApp {
    public static void main(String[] args) throws IOException {
        new SocksServer(Configuration.newUnmodifiableInstance(Settings.of(
            Setting.newInstanceWithParsedValue(
                &quot;socks5.methods&quot;, 
                &quot;NO_AUTHENTICATION_REQUIRED,GSSAPI&quot;)
        ))).start();
    }
}
</code></pre></div>
<p>Command line example:</p>

<div class="verbatim">
<pre><code class="language-bash">jargyle start-server --setting=socks5.methods=NO_AUTHENTICATION_REQUIRED,GSSAPI
</code></pre></div>
<p>In the server configuration file, you can have one or more of the aforementioned
authentication methods set in the setting <code>socks5.methods</code> as a
<code>&lt;socks5.methods/&gt;</code> XML element with one or more <code>&lt;socks5.method/&gt;</code> XML
elements each specifying an authentication method.</p>
<p>Server configuration file example:</p>

<div class="verbatim">
<pre><code class="language-xml">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot; standalone=&quot;yes&quot;?&gt;
&lt;configuration&gt;
    &lt;settings&gt;
        &lt;setting&gt;
            &lt;name&gt;socks5.methods&lt;/name&gt;
            &lt;socks5.methods&gt;
                &lt;socks5.method&gt;GSSAPI&lt;/socks5.method&gt;
                &lt;socks5.method&gt;USERNAME_PASSWORD&lt;/socks5.method&gt;
            &lt;/socks5.methods&gt;
        &lt;/setting&gt;
    &lt;/settings&gt;
&lt;/configuration&gt;
</code></pre></div>
<p>If not set, the default value for the setting <code>socks5.methods</code> is set to <code>NO_AUTHENTICATION_REQUIRED</code></p><section>
<h3>Using No Authentication</h3>
<p>Because the default value for the setting <code>socks5.methods</code> is set to
<code>NO_AUTHENTICATION_REQUIRED</code>, it is not required for
<code>NO_AUTHENTICATION_REQUIRED</code> to be included in the setting
<code>socks5.methods</code>.</p>
<p>However, if other authentication methods are to be used in addition to
<code>NO_AUTHENTICATION_REQUIRED</code>, <code>NO_AUTHENTICATION_REQUIRED</code> must be
included in the setting <code>socks5.methods</code></p>
<p>API example:</p>

<div class="verbatim">
<pre><code class="language-java">package com.example;

import com.github.jh3nd3rs0n.jargyle.server.Configuration;
import com.github.jh3nd3rs0n.jargyle.server.Setting;
import com.github.jh3nd3rs0n.jargyle.server.Settings;
import com.github.jh3nd3rs0n.jargyle.server.SocksServer;

import java.io.IOException;

public class ServerApp {
    public static void main(String[] args) throws IOException {
        new SocksServer(Configuration.newUnmodifiableInstance(Settings.of(
            Setting.newInstanceWithParsedValue(
                &quot;socks5.methods&quot;, 
                &quot;NO_AUTHENTICATION_REQUIRED,GSSAPI,USERNAME_PASSWORD&quot;)
        ))).start();
    }
}
</code></pre></div>
<p>Command line example:</p>

<div class="verbatim">
<pre><code class="language-bash">jargyle start-server --setting=socks5.methods=NO_AUTHENTICATION_REQUIRED,GSSAPI,USERNAME_PASSWORD
</code></pre></div>
<p>Server configuration file example:</p>

<div class="verbatim">
<pre><code class="language-xml">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot; standalone=&quot;yes&quot;?&gt;
&lt;configuration&gt;
    &lt;settings&gt;
        &lt;setting&gt;
            &lt;name&gt;socks5.methods&lt;/name&gt;
            &lt;socks5.methods&gt;
                &lt;socks5.method&gt;NO_AUTHENTICATION_REQUIRED&lt;/socks5.method&gt;
                &lt;socks5.method&gt;GSSAPI&lt;/socks5.method&gt;
                &lt;socks5.method&gt;USERNAME_PASSWORD&lt;/socks5.method&gt;
            &lt;/socks5.methods&gt;
        &lt;/setting&gt;
    &lt;/settings&gt;
&lt;/configuration&gt;
</code></pre></div></section><section>
<h3>Using Username Password Authentication</h3>
<p>To use username password authentication, you will need to have the setting
<code>socks5.methods</code> to have <code>USERNAME_PASSWORD</code> included. You will also need
to have the setting <code>socks5.userpassmethod.userRepository</code> to specify the
type name of the user repository along with an initialization string value.</p>
<p>The following are two type names you can use:</p>
<ul>

<li><code>FileSourceUserRepository</code></li>
<li><code>StringSourceUserRepository</code></li>
</ul>
<p><code>FileSourceUserRepository</code>: This user repository handles the storage of the
SOCKS5 users from an initialization string value of a provided file of a list of
URL encoded username and hashed password pairs. The SOCKS5 users from the file
are loaded onto memory. Because of this, you will need at least as much memory
as the size of the file. If the file does not exist, it will be created and
used. If the file does exist, the existing file will be used. To manage SOCKS5
users under a user repository, see
<a href="cli.html#managing-socks5-users">Managing SOCKS5 Users</a>.</p>
<p>API example:</p>

<div class="verbatim">
<pre><code class="language-java">package com.example;

import com.github.jh3nd3rs0n.jargyle.server.Configuration;
import com.github.jh3nd3rs0n.jargyle.server.Setting;
import com.github.jh3nd3rs0n.jargyle.server.Settings;
import com.github.jh3nd3rs0n.jargyle.server.SocksServer;

import java.io.IOException;

public class ServerApp {
    public static void main(String[] args) throws IOException {
        new SocksServer(Configuration.newUnmodifiableInstance(Settings.of(
            Setting.newInstanceWithParsedValue(
                &quot;socks5.methods&quot;, &quot;USERNAME_PASSWORD&quot;),
            Setting.newInstanceWithParsedValue(
                &quot;socks5.userpassmethod.userRepository&quot;, 
                &quot;FileSourceUserRepository:users&quot;)
        ))).start();
    }
}
</code></pre></div>
<p>Command line example:</p>

<div class="verbatim">
<pre><code class="language-bash">jargyle start-server \
    --setting=socks5.methods=USERNAME_PASSWORD \
    --setting=socks5.userpassmethod.userRepository=FileSourceUserRepository:users
</code></pre></div>
<p>Server configuration file example:</p>

<div class="verbatim">
<pre><code class="language-xml">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot; standalone=&quot;yes&quot;?&gt;
&lt;configuration&gt;
    &lt;settings&gt;
        &lt;setting&gt;
            &lt;name&gt;socks5.methods&lt;/name&gt;
            &lt;socks5.methods&gt;
                &lt;socks5.method&gt;USERNAME_PASSWORD&lt;/socks5.method&gt;
            &lt;/socks5.methods&gt;
        &lt;/setting&gt;
        &lt;setting&gt;
            &lt;name&gt;socks5.userpassmethod.userRepository&lt;/name&gt;
            &lt;socks5.userpassmethod.userRepository&gt;
                &lt;typeName&gt;FileSourceUserRepository&lt;/typeName&gt;
                &lt;initializationString&gt;users&lt;/initializationString&gt;
            &lt;/socks5.userpassmethod.userRepository&gt;
        &lt;/setting&gt;
    &lt;/settings&gt;
&lt;/configuration&gt;
</code></pre></div>
<p><code>StringSourceUserRepository</code>: This user repository handles the storage of
the SOCKS5 users from an initialization string value of a comma separated list
of URL encoded username and password pairs.</p>
<p>Each username and password pair in the comma separated list must be of the
following format:</p>

<div class="verbatim">
<pre><code class="language-text">USERNAME:PASSWORD
</code></pre></div>
<p><code>USERNAME</code> is the username and <code>PASSWORD</code> is the password.</p>
<p>If the username or the password contains a colon character (<code>:</code>), then each
colon character must be replaced with the URL encoding character <code>%3A</code>.</p>
<p>If the username or the password contains a comma character (<code>,</code>), then each
comma character must be replaced with the URL encoding character <code>%2C</code>.</p>
<p>If the username or the password contains a percent sign character (<code>%</code>) not
used for URL encoding, then each percent sign character not used for URL
encoding must be replaced with the URL encoding character <code>%25</code>.</p>
<p>API example:</p>

<div class="verbatim">
<pre><code class="language-java">package com.example;

import com.github.jh3nd3rs0n.jargyle.server.Configuration;
import com.github.jh3nd3rs0n.jargyle.server.Setting;
import com.github.jh3nd3rs0n.jargyle.server.Settings;
import com.github.jh3nd3rs0n.jargyle.server.SocksServer;

import java.io.IOException;

public class ServerApp {
    public static void main(String[] args) throws IOException {
        new SocksServer(Configuration.newUnmodifiableInstance(Settings.of(
            Setting.newInstanceWithParsedValue(
                &quot;socks5.methods&quot;, &quot;USERNAME_PASSWORD&quot;),
            Setting.newInstanceWithParsedValue(
                &quot;socks5.userpassmethod.userRepository&quot;,
                &quot;StringSourceUserRepository:Aladdin:opensesame,Jasmine:mission%3Aimpossible&quot;)
        ))).start();
    }
}
</code></pre></div>
<p>Command line example:</p>

<div class="verbatim">
<pre><code class="language-bash">jargyle start-server \
    --setting=socks5.methods=USERNAME_PASSWORD \
    --setting=socks5.userpassmethod.userRepository=StringSourceUserRepository:Aladdin:opensesame,Jasmine:mission%3Aimpossible
</code></pre></div>
<p>Server configuration file example:</p>

<div class="verbatim">
<pre><code class="language-xml">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot; standalone=&quot;yes&quot;?&gt;
&lt;configuration&gt;
    &lt;settings&gt;
        &lt;setting&gt;
            &lt;name&gt;socks5.methods&lt;/name&gt;
            &lt;socks5.methods&gt;
                &lt;socks5.method&gt;USERNAME_PASSWORD&lt;/socks5.method&gt;
            &lt;/socks5.methods&gt;
        &lt;/setting&gt;
        &lt;setting&gt;
            &lt;name&gt;socks5.userpassmethod.userRepository&lt;/name&gt;
            &lt;socks5.userpassmethod.userRepository&gt;
                &lt;typeName&gt;StringSourceUserRepository&lt;/typeName&gt;
                &lt;initializationString&gt;Aladdin:opensesame,Jasmine:mission%3Aimpossible&lt;/initializationString&gt;
            &lt;/socks5.userpassmethod.userRepository&gt;
        &lt;/setting&gt;
    &lt;/settings&gt;
&lt;/configuration&gt;
</code></pre></div></section><section>
<h3>Using GSS-API Authentication</h3>
<p>To use GSS-API authentication, you will need to have the setting
<code>socks5.methods</code> to have <code>GSSAPI</code> included. You will need to specify Java
system properties to use a security mechanism that implements the GSS-API (for
example, Kerberos is a security mechanism that implements the GSS-API).</p>
<p>The following are sufficient examples of using the Kerberos security mechanism:</p>
<p>API example:</p>

<div class="verbatim">
<pre><code class="language-java">package com.example;

import com.github.jh3nd3rs0n.jargyle.server.Configuration;
import com.github.jh3nd3rs0n.jargyle.server.Setting;
import com.github.jh3nd3rs0n.jargyle.server.Settings;
import com.github.jh3nd3rs0n.jargyle.server.SocksServer;

import java.io.IOException;

public class ServerApp {
    public static void main(String[] args) throws IOException {
        System.setProperty(
            &quot;javax.security.auth.useSubjectCredsOnly&quot;, &quot;true&quot;);
        System.setProperty(
            &quot;java.security.auth.login.config&quot;, &quot;login.conf&quot;);
        System.setProperty(&quot;java.security.krb5.conf&quot;, &quot;krb5.conf&quot;);
        new SocksServer(Configuration.newUnmodifiableInstance(Settings.of(
            Setting.newInstanceWithParsedValue(
                &quot;socks5.methods&quot;, &quot;GSSAPI&quot;)
        ))).start();
    }
}
</code></pre></div>
<p>Command line example:</p>

<div class="verbatim">
<pre><code class="language-bash">export JARGYLE_OPTS=&quot;-Djavax.security.auth.useSubjectCredsOnly=false -Djava.security.auth.login.config=login.conf -Djava.security.krb5.conf=krb5.conf&quot;
jargyle start-server --setting=socks5.methods=GSSAPI 
</code></pre></div>
<p>Server configuration file example:</p>

<div class="verbatim">
<pre><code class="language-xml">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot; standalone=&quot;yes&quot;?&gt;
&lt;!--
Before running this file, the following must be executed:
export JARGYLE_OPTS=&quot;-Djavax.security.auth.useSubjectCredsOnly=false -Djava.security.auth.login.config=login.conf -Djava.security.krb5.conf=krb5.conf&quot;
--&gt;
&lt;configuration&gt;
    &lt;settings&gt;
        &lt;setting&gt;
            &lt;name&gt;socks5.methods&lt;/name&gt;
            &lt;socks5.methods&gt;
                &lt;socks5.method&gt;GSSAPI&lt;/socks5.method&gt;
            &lt;/socks5.methods&gt;
        &lt;/setting&gt;
    &lt;/settings&gt;
&lt;/configuration&gt;
</code></pre></div>
<p>The Java system property <code>javax.security.auth.useSubjectCredsOnly</code> with
the value <code>false</code> disables JAAS-based authentication to obtain the credentials
directly and lets the underlying security mechanism obtain them instead.</p>
<p>The Java system property <code>java.security.auth.login.config</code> with the value
<code>login.conf</code> provides a JAAS configuration file for the underlying security
mechanism.</p>
<p><code>login.conf</code>:</p>

<div class="verbatim">
<pre><code class="language-text">com.sun.security.jgss.accept {
  com.sun.security.auth.module.Krb5LoginModule required
  principal=&quot;rcmd/127.0.0.1&quot;
  useKeyTab=true
  keyTab=&quot;rcmd.keytab&quot;
  storeKey=true;
};
</code></pre></div>
<p>In <code>login.conf</code>, <code>rcmd/127.0.0.1</code> is a service principal that is created by
a Kerberos administrator specifically for a SOCKS5 server with the service name
<code>rcmd</code> residing at the address <code>127.0.0.1</code>. (In a production environment, the
address <code>127.0.0.1</code> should be replaced by the name of the machine of where the
SOCKS5 server resides.)</p>
<p>Also in <code>login.conf</code>, <code>rcmd.keytab</code> is a keytab file also created by a
Kerberos administrator that contains the aforementioned service principal and
its respective encrypted key.</p>
<p>The Java system property <code>java.security.krb5.conf</code> with the value
<code>krb5.conf</code> provides the Kerberos configuration file that points to the
Kerberos Key Distribution Center (KDC) for authentication.</p>
<p><code>krb5.conf</code>:</p>

<div class="verbatim">
<pre><code class="language-text">[libdefaults]
    kdc_realm = EXAMPLE.COM
    default_realm = EXAMPLE.COM
    udp_preference_limit = 4096
    kdc_tcp_port = 12345
    kdc_udp_port = 12345

[realms]
    EXAMPLE.COM = {
        kdc = 127.0.0.1:12345
    }
</code></pre></div>
<p>In <code>krb5.conf</code>, a KDC is defined as running at the address <code>127.0.0.1</code> on
port <code>12345</code> with its realm as <code>EXAMPLE.COM</code>. (In a production environment,
the address <code>127.0.0.1</code> should be replaced by the actual address or name of
the machine of where the KDC resides. Also, in a production environment, the
realm <code>EXAMPLE.COM</code> should be replaced by an actual realm provided by a
Kerberos administrator.)</p></section></section><section>
<h2>Chaining to Another SOCKS Server</h2>
<p>You can have the server chained to another SOCKS server, meaning that its
traffic can be routed through another SOCKS server. To have the server chained
to another SOCKS server, you will need to specify the other SOCKS server as a
URI in the setting <code>chaining.socksServerUri</code></p>
<p>API example:</p>

<div class="verbatim">
<pre><code class="language-java">package com.example;

import com.github.jh3nd3rs0n.jargyle.server.Configuration;
import com.github.jh3nd3rs0n.jargyle.server.Setting;
import com.github.jh3nd3rs0n.jargyle.server.Settings;
import com.github.jh3nd3rs0n.jargyle.server.SocksServer;

import java.io.IOException;

public class ServerApp {
    public static void main(String[] args) throws IOException {
        new SocksServer(Configuration.newUnmodifiableInstance(Settings.of(
            Setting.newInstanceWithParsedValue(
                &quot;chaining.socksServerUri&quot;, 
                &quot;socks5://127.0.0.1:23456&quot;)
        ))).start();
    }
}
</code></pre></div>
<p>Command line example:</p>

<div class="verbatim">
<pre><code class="language-bash">jargyle start-server --setting=chaining.socksServerUri=socks5://127.0.0.1:23456
</code></pre></div>
<p>Server configuration file example:</p>

<div class="verbatim">
<pre><code class="language-xml">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot; standalone=&quot;yes&quot;?&gt;
&lt;configuration&gt;
    &lt;settings&gt;
        &lt;setting&gt;
            &lt;name&gt;chaining.socksServerUri&lt;/name&gt;
            &lt;value&gt;socks5://127.0.0.1:23456&lt;/value&gt;
        &lt;/setting&gt;
    &lt;/settings&gt;
&lt;/configuration&gt;
</code></pre></div>
<p>Please note that the scheme in the URI specifies the SOCKS protocol to be used
when accessing the other SOCKS server (<code>socks5</code>), the address or name of the
machine of where the other SOCKS server resides (<code>127.0.0.1</code>), and the port
number of the other SOCKS server (<code>23456</code>). In the aforementioned examples, the
SOCKS protocol version 5 is used. At this time, the only supported scheme for
the URI format is <code>socks5</code></p>
<p><a id="enabling-ssltls-for-tcp-traffic-between-the-server-and-the-other-socks-server"></a></p><section>
<h3>Enabling SSL/TLS for TCP Traffic Between the Server and the Other SOCKS Server</h3>
<p>You can enable SSL/TLS for TCP traffic between the server and the other SOCKS
server under the following condition:</p>
<ul>

<li>The other SOCKS server accepts SSL/TLS connections.</li>
</ul>
<p>By default, SSL/TLS for TCP traffic between the server and the other SOCKS server
is disabled. To enable SSL/TLS for TCP traffic between the server and the other
SOCKS server, you will need to have the setting <code>chaining.ssl.enabled</code> set
to <code>true</code>. In addition, you will need to have the setting
<code>chaining.ssl.trustStoreFile</code> to specify the other SOCKS server's key store
file used as a trust store (this file would need to be created by Java's keytool
utility). Also, you will need to have the setting
<code>chaining.ssl.trustStorePassword</code> to specify the password for the other
SOCKS server's trust store file.</p>
<p>API example:</p>

<div class="verbatim">
<pre><code class="language-java">package com.example;

import com.github.jh3nd3rs0n.jargyle.server.Configuration;
import com.github.jh3nd3rs0n.jargyle.server.Setting;
import com.github.jh3nd3rs0n.jargyle.server.Settings;
import com.github.jh3nd3rs0n.jargyle.server.SocksServer;

import java.io.IOException;

public class ServerApp {
    public static void main(String[] args) throws IOException {
        new SocksServer(Configuration.newUnmodifiableInstance(Settings.of(
            Setting.newInstanceWithParsedValue(
                &quot;chaining.socksServerUri&quot;, 
                &quot;socks5://127.0.0.1:23456&quot;),
            Setting.newInstanceWithParsedValue(
                &quot;chaining.ssl.enabled&quot;, &quot;true&quot;),
            Setting.newInstanceWithParsedValue(
                &quot;chaining.ssl.trustStoreFile&quot;, &quot;server.jks&quot;),
            Setting.newInstanceWithParsedValue(
                &quot;chaining.ssl.trustStorePassword&quot;, &quot;password&quot;)
        ))).start();
    }
}
</code></pre></div>
<p>Command line example:</p>

<div class="verbatim">
<pre><code class="language-bash">jargyle start-server \
    --setting=chaining.socksServerUri=socks5://127.0.0.1:23456 \
    --setting=chaining.ssl.enabled=true \
    --setting=chaining.ssl.trustStoreFile=server.jks \
    --setting=chaining.ssl.trustStorePassword=password
</code></pre></div>
<p>Server configuration file example:</p>

<div class="verbatim">
<pre><code class="language-xml">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot; standalone=&quot;yes&quot;?&gt;
&lt;configuration&gt;
    &lt;settings&gt;
        &lt;setting&gt;
            &lt;name&gt;chaining.socksServerUri&lt;/name&gt;
            &lt;value&gt;socks5://127.0.0.1:23456&lt;/value&gt;
        &lt;/setting&gt;
        &lt;setting&gt;
            &lt;name&gt;chaining.ssl.enabled&lt;/name&gt;
            &lt;value&gt;true&lt;/value&gt;
        &lt;/setting&gt;
        &lt;setting&gt;
            &lt;name&gt;chaining.ssl.trustStoreFile&lt;/name&gt;
            &lt;value&gt;server.jks&lt;/value&gt;
        &lt;/setting&gt;
        &lt;setting&gt;
            &lt;name&gt;chaining.ssl.trustStorePassword&lt;/name&gt;
            &lt;value&gt;password&lt;/value&gt;
            &lt;doc&gt;If this configuration file was created by new-server-config-file, the password would be encrypted&lt;/doc&gt;
        &lt;/setting&gt;
    &lt;/settings&gt;
&lt;/configuration&gt;
</code></pre></div>
<p>If you do not want to have the password appear in any script or in any part of
the command line history for security reasons, you can use the command line
option <code>--enter-chaining-ssl-trust-store-pass</code> instead. It will provide
an interactive prompt for you to enter the password.</p>
<p>Command line example:</p>

<div class="verbatim">
<pre><code class="language-bash">jargyle start-server \
    --setting=chaining.socksServerUri=socks5://127.0.0.1:23456 \
    --setting=chaining.ssl.enabled=true \
    --setting=chaining.ssl.trustStoreFile=server.jks \
    --enter-chaining-ssl-trust-store-pass
</code></pre></div>
<p>If the other SOCKS server wants the client (the server) to authenticate using
SSL/TLS, you will need to have the setting <code>chaining.ssl.keyStoreFile</code> to
specify the client's key store file (this file would need to be created by
Java's keytool utility). Also, you will need to have the setting
<code>chaining.ssl.keyStorePassword</code> to specify the password for the client's
key store file.</p>
<p>API example:</p>

<div class="verbatim">
<pre><code class="language-java">package com.example;

import com.github.jh3nd3rs0n.jargyle.server.Configuration;
import com.github.jh3nd3rs0n.jargyle.server.Setting;
import com.github.jh3nd3rs0n.jargyle.server.Settings;
import com.github.jh3nd3rs0n.jargyle.server.SocksServer;

import java.io.IOException;

public class ServerApp {
    public static void main(String[] args) throws IOException {
        new SocksServer(Configuration.newUnmodifiableInstance(Settings.of(
            Setting.newInstanceWithParsedValue(
                &quot;chaining.socksServerUri&quot;, 
                &quot;socks5://127.0.0.1:23456&quot;),
            Setting.newInstanceWithParsedValue(
                &quot;chaining.ssl.enabled&quot;, &quot;true&quot;),
            Setting.newInstanceWithParsedValue(
                &quot;chaining.ssl.keyStoreFile&quot;, &quot;client.jks&quot;),
            Setting.newInstanceWithParsedValue(
                &quot;chaining.ssl.keyStorePassword&quot;, &quot;drowssap&quot;),
            Setting.newInstanceWithParsedValue(
                &quot;chaining.ssl.trustStoreFile&quot;, &quot;server.jks&quot;),
            Setting.newInstanceWithParsedValue(
                &quot;chaining.ssl.trustStorePassword&quot;, &quot;password&quot;)
        ))).start();
    }
}
</code></pre></div>
<p>Command line example:</p>

<div class="verbatim">
<pre><code class="language-bash">jargyle start-server \
    --setting=chaining.socksServerUri=socks5://127.0.0.1:23456 \
    --setting=chaining.ssl.enabled=true \
    --setting=chaining.ssl.keyStoreFile=client.jks \
    --setting=chaining.ssl.keyStorePassword=drowssap \
    --setting=chaining.ssl.trustStoreFile=server.jks \
    --setting=chaining.ssl.trustStorePassword=password    
</code></pre></div>
<p>Server configuration file example:</p>

<div class="verbatim">
<pre><code class="language-xml">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot; standalone=&quot;yes&quot;?&gt;
&lt;configuration&gt;
    &lt;settings&gt;
        &lt;setting&gt;
            &lt;name&gt;chaining.socksServerUri&lt;/name&gt;
            &lt;value&gt;socks5://127.0.0.1:23456&lt;/value&gt;
        &lt;/setting&gt;
        &lt;setting&gt;
            &lt;name&gt;chaining.ssl.enabled&lt;/name&gt;
            &lt;value&gt;true&lt;/value&gt;
        &lt;/setting&gt;
        &lt;setting&gt;
            &lt;name&gt;chaining.ssl.keyStoreFile&lt;/name&gt;
            &lt;value&gt;client.jks&lt;/value&gt;
        &lt;/setting&gt;
        &lt;setting&gt;
            &lt;name&gt;chaining.ssl.keyStorePassword&lt;/name&gt;
            &lt;value&gt;drowssap&lt;/value&gt;
            &lt;doc&gt;If this configuration file was created by new-server-config-file, the password would be encrypted&lt;/doc&gt;
        &lt;/setting&gt;
        &lt;setting&gt;
            &lt;name&gt;chaining.ssl.trustStoreFile&lt;/name&gt;
            &lt;value&gt;server.jks&lt;/value&gt;
        &lt;/setting&gt;
        &lt;setting&gt;
            &lt;name&gt;chaining.ssl.trustStorePassword&lt;/name&gt;
            &lt;value&gt;password&lt;/value&gt;
            &lt;doc&gt;If this configuration file was created by new-server-config-file, the password would be encrypted&lt;/doc&gt;
        &lt;/setting&gt;
    &lt;/settings&gt;
&lt;/configuration&gt;
</code></pre></div>
<p>If you do not want to have the password appear in any script or in any part of
the command line history for security reasons, you can use the command line
option <code>--enter-chaining-ssl-key-store-pass</code> instead. It will provide an
interactive prompt for you to enter the password.</p>
<p>Command line example:</p>

<div class="verbatim">
<pre><code class="language-bash">jargyle start-server \
    --setting=chaining.socksServerUri=socks5://127.0.0.1:23456 \
    --setting=chaining.ssl.enabled=true \
    --setting=chaining.ssl.keyStoreFile=client.jks \
    --enter-chaining-ssl-key-store-pass \
    --setting=chaining.ssl.trustStoreFile=server.jks \
    --enter-chaining-ssl-trust-store-pass
</code></pre></div>
<p><a id="enabling-dtls-for-udp-traffic-between-the-server-and-the-other-socks-server"></a></p></section><section>
<h3>Enabling DTLS for UDP Traffic Between the Server and the Other SOCKS Server</h3>
<p>You can enable DTLS for UDP traffic between the server and the other SOCKS
server under the following condition:</p>
<ul>

<li>The other SOCKS server accepts DTLS connections.</li>
</ul>
<p>By default, DTLS for UDP traffic between the server and the other SOCKS server is
disabled. To enable DTLS for UDP traffic between the server and the other SOCKS
server, you will need to have the setting <code>chaining.dtls.enabled</code> set to
<code>true</code>. In addition, you will need to have the setting
<code>chaining.dtls.trustStoreFile</code> to specify the other SOCKS server's key
store file used as a trust store (this file would need to be created by Java's
keytool utility). Also, you will need to have the setting
<code>chaining.dtls.trustStorePassword</code> to specify the password for the other
SOCKS server's trust store file.</p>
<p>API example:</p>

<div class="verbatim">
<pre><code class="language-java">package com.example;

import com.github.jh3nd3rs0n.jargyle.server.Configuration;
import com.github.jh3nd3rs0n.jargyle.server.Setting;
import com.github.jh3nd3rs0n.jargyle.server.Settings;
import com.github.jh3nd3rs0n.jargyle.server.SocksServer;

import java.io.IOException;

public class ServerApp {
    public static void main(String[] args) throws IOException {
        new SocksServer(Configuration.newUnmodifiableInstance(Settings.of(
            Setting.newInstanceWithParsedValue(
                &quot;chaining.socksServerUri&quot;, 
                &quot;socks5://127.0.0.1:23456&quot;),
            Setting.newInstanceWithParsedValue(
                &quot;chaining.dtls.enabled&quot;, &quot;true&quot;),
            Setting.newInstanceWithParsedValue(
                &quot;chaining.dtls.trustStoreFile&quot;, &quot;server.jks&quot;),
            Setting.newInstanceWithParsedValue(
                &quot;chaining.dtls.trustStorePassword&quot;, &quot;password&quot;)
        ))).start();
    }
}
</code></pre></div>
<p>Command line example:</p>

<div class="verbatim">
<pre><code class="language-bash">jargyle start-server \
    --setting=chaining.socksServerUri=socks5://127.0.0.1:23456 \
    --setting=chaining.dtls.enabled=true \
    --setting=chaining.dtls.trustStoreFile=server.jks \
    --setting=chaining.dtls.trustStorePassword=password
</code></pre></div>
<p>Server configuration file example:</p>

<div class="verbatim">
<pre><code class="language-xml">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot; standalone=&quot;yes&quot;?&gt;
&lt;configuration&gt;
    &lt;settings&gt;
        &lt;setting&gt;
            &lt;name&gt;chaining.socksServerUri&lt;/name&gt;
            &lt;value&gt;socks5://127.0.0.1:23456&lt;/value&gt;
        &lt;/setting&gt;
        &lt;setting&gt;
            &lt;name&gt;chaining.dtls.enabled&lt;/name&gt;
            &lt;value&gt;true&lt;/value&gt;
        &lt;/setting&gt;
        &lt;setting&gt;
            &lt;name&gt;chaining.dtls.trustStoreFile&lt;/name&gt;
            &lt;value&gt;server.jks&lt;/value&gt;
        &lt;/setting&gt;
        &lt;setting&gt;
            &lt;name&gt;chaining.dtls.trustStorePassword&lt;/name&gt;
            &lt;value&gt;password&lt;/value&gt;
            &lt;doc&gt;If this configuration file was created by new-server-config-file, the password would be encrypted&lt;/doc&gt;
        &lt;/setting&gt;
    &lt;/settings&gt;
&lt;/configuration&gt;
</code></pre></div>
<p>If you do not want to have the password appear in any script or in any part of
the command line history for security reasons, you can use the command line
option <code>--enter-chaining-dtls-trust-store-pass</code> instead. It will provide
an interactive prompt for you to enter the password.</p>
<p>Command line example:</p>

<div class="verbatim">
<pre><code class="language-bash">jargyle start-server \
    --setting=chaining.socksServerUri=socks5://127.0.0.1:23456 \
    --setting=chaining.dtls.enabled=true \
    --setting=chaining.dtls.trustStoreFile=server.jks \
    --enter-chaining-dtls-trust-store-pass
</code></pre></div></section><section>
<h3>Chaining to the Other SOCKS Server Using SOCKS5 Authentication</h3>
<p>The server has the following SOCKS5 authentication methods to choose from when
chaining to the other SOCKS5 server:</p>
<ul>

<li><code>NO_AUTHENTICATION_REQUIRED</code>: No authentication required</li>
<li><code>GSSAPI</code>: GSS-API authentication</li>
<li><code>USERNAME_PASSWORD</code>: Username password authentication</li>
</ul>
<p>From the API and from the command line, you can have one or more of the
aforementioned authentication methods set in the setting
<code>chaining.socks5.methods</code> as a comma separated list.</p>
<p>API example:</p>

<div class="verbatim">
<pre><code class="language-java">package com.example;

import com.github.jh3nd3rs0n.jargyle.server.Configuration;
import com.github.jh3nd3rs0n.jargyle.server.Setting;
import com.github.jh3nd3rs0n.jargyle.server.Settings;
import com.github.jh3nd3rs0n.jargyle.server.SocksServer;

import java.io.IOException;

public class ServerApp {
    public static void main(String[] args) throws IOException {
        new SocksServer(Configuration.newUnmodifiableInstance(Settings.of(
            Setting.newInstanceWithParsedValue(
                &quot;chaining.socksServerUri&quot;, 
                &quot;socks5://127.0.0.1:23456&quot;),
            Setting.newInstanceWithParsedValue(
                &quot;chaining.socks5.methods&quot;,
                &quot;NO_AUTHENTICATION_REQUIRED,GSSAPI&quot;)
        ))).start();
    }
}
</code></pre></div>
<p>Command line example:</p>

<div class="verbatim">
<pre><code class="language-bash">jargyle start-server \
    --setting=chaining.socksServerUri=socks5://127.0.0.1:23456 \
    --setting=chaining.socks5.methods=NO_AUTHENTICATION_REQUIRED,GSSAPI
</code></pre></div>
<p>In the configuration file, you can have one or more of the aforementioned
authentication methods set in the setting <code>chaining.socks5.methods</code> as a
<code>&lt;socks5.methods/&gt;</code> XML element with one or more <code>&lt;socks5.method/&gt;</code> XML
elements each specifying an authentication method.</p>
<p>Server configuration file example:</p>

<div class="verbatim">
<pre><code class="language-xml">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot; standalone=&quot;yes&quot;?&gt;
&lt;configuration&gt;
    &lt;settings&gt;
        &lt;setting&gt;
            &lt;name&gt;chaining.socksServerUri&lt;/name&gt;
            &lt;value&gt;socks5://127.0.0.1:23456&lt;/value&gt;
        &lt;/setting&gt;
        &lt;setting&gt;
            &lt;name&gt;chaining.socks5.methods&lt;/name&gt;
            &lt;socks5.methods&gt;
                &lt;socks5.method&gt;GSSAPI&lt;/socks5.method&gt;
                &lt;socks5.method&gt;USERNAME_PASSWORD&lt;/socks5.method&gt;
            &lt;/socks5.methods&gt;
        &lt;/setting&gt;
    &lt;/settings&gt;
&lt;/configuration&gt;
</code></pre></div>
<p>If not set, the default value for the setting <code>chaining.socks5.methods</code> is
set to <code>NO_AUTHENTICATION_REQUIRED</code>.</p><section>
<h4>Chaining to the Other SOCKS Server Using No Authentication</h4>
<p>Because the default value for the setting <code>chaining.socks5.methods</code> is set
to <code>NO_AUTHENTICATION_REQUIRED</code>, it is not required for
<code>NO_AUTHENTICATION_REQUIRED</code> to be included in the setting
<code>chaining.socks5.methods</code>.</p>
<p>However, if other authentication methods are to be used in addition to
<code>NO_AUTHENTICATION_REQUIRED</code>, <code>NO_AUTHENTICATION_REQUIRED</code> must be
included in the setting <code>chaining.socks5.methods</code></p>
<p>API example:</p>

<div class="verbatim">
<pre><code class="language-java">package com.example;

import com.github.jh3nd3rs0n.jargyle.server.Configuration;
import com.github.jh3nd3rs0n.jargyle.server.Setting;
import com.github.jh3nd3rs0n.jargyle.server.Settings;
import com.github.jh3nd3rs0n.jargyle.server.SocksServer;

import java.io.IOException;

public class ServerApp {
    public static void main(String[] args) throws IOException {
        new SocksServer(Configuration.newUnmodifiableInstance(Settings.of(
            Setting.newInstanceWithParsedValue(
                &quot;chaining.socksServerUri&quot;, 
                &quot;socks5://127.0.0.1:23456&quot;),
            Setting.newInstanceWithParsedValue(
                &quot;chaining.socks5.methods&quot;,
                &quot;NO_AUTHENTICATION_REQUIRED,GSSAPI,USERNAME_PASSWORD&quot;)
        ))).start();
    }
}
</code></pre></div>
<p>Command line example:</p>

<div class="verbatim">
<pre><code class="language-bash">jargyle start-server \
    --setting=chaining.socksServerUri=socks5://127.0.0.1:23456 \
    --setting=chaining.socks5.methods=NO_AUTHENTICATION_REQUIRED,GSSAPI,USERNAME_PASSWORD
</code></pre></div>
<p>Server configuration file example:</p>

<div class="verbatim">
<pre><code class="language-xml">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot; standalone=&quot;yes&quot;?&gt;
&lt;configuration&gt;
    &lt;settings&gt;
        &lt;setting&gt;
            &lt;name&gt;chaining.socksServerUri&lt;/name&gt;
            &lt;value&gt;socks5://127.0.0.1:23456&lt;/value&gt;
        &lt;/setting&gt;
        &lt;setting&gt;
            &lt;name&gt;chaining.socks5.methods&lt;/name&gt;
            &lt;socks5.methods&gt;
                &lt;socks5.method&gt;NO_AUTHENTICATION_REQUIRED&lt;/socks5.method&gt;
                &lt;socks5.method&gt;GSSAPI&lt;/socks5.method&gt;
                &lt;socks5.method&gt;USERNAME_PASSWORD&lt;/socks5.method&gt;
            &lt;/socks5.methods&gt;
        &lt;/setting&gt;
    &lt;/settings&gt;
&lt;/configuration&gt;
</code></pre></div>
<p><a id="chaining-to-the-other-socks-server-using-username-password-authentication"></a></p></section><section>
<h4>Chaining to the Other SOCKS Server Using Username Password Authentication</h4>
<p>To chain to the other SOCKS server using username password authentication, you
will need to have the setting <code>chaining.socks5.methods</code> to have
<code>USERNAME_PASSWORD</code> included. You will also need to have the settings
<code>chaining.socks5.userpassmethod.username</code> and
<code>chaining.socks5.userpassmethod.password</code> respectively specify the
username and password for the other SOCKS5 server.</p>
<p>API example:</p>

<div class="verbatim">
<pre><code class="language-java">package com.example;

import com.github.jh3nd3rs0n.jargyle.server.Configuration;
import com.github.jh3nd3rs0n.jargyle.server.Setting;
import com.github.jh3nd3rs0n.jargyle.server.Settings;
import com.github.jh3nd3rs0n.jargyle.server.SocksServer;

import java.io.IOException;

public class ServerApp {
    public static void main(String[] args) throws IOException {
        new SocksServer(Configuration.newUnmodifiableInstance(Settings.of(
            Setting.newInstanceWithParsedValue(
                &quot;chaining.socksServerUri&quot;, 
                &quot;socks5://127.0.0.1:23456&quot;),
            Setting.newInstanceWithParsedValue(
                &quot;chaining.socks5.methods&quot;, &quot;USERNAME_PASSWORD&quot;),
            Setting.newInstanceWithParsedValue(
                &quot;chaining.socks5.userpassmethod.username&quot;,
                &quot;Aladdin&quot;),
            Setting.newInstanceWithParsedValue(
                &quot;chaining.socks5.userpassmethod.password&quot;,
                &quot;opensesame&quot;)
        ))).start();
    }
}
</code></pre></div>
<p>Command line example:</p>

<div class="verbatim">
<pre><code class="language-bash">jargyle start-server \
    --setting=chaining.socksServerUri=socks5://127.0.0.1:23456 \
    --setting=chaining.socks5.methods=USERNAME_PASSWORD \
    --setting=chaining.socks5.userpassmethod.username=Aladdin \
    --setting=chaining.socks5.userpassmethod.password=opensesame
</code></pre></div>
<p>Server configuration file example:</p>

<div class="verbatim">
<pre><code class="language-xml">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot; standalone=&quot;yes&quot;?&gt;
&lt;configuration&gt;
    &lt;settings&gt;
        &lt;setting&gt;
            &lt;name&gt;chaining.socksServerUri&lt;/name&gt;
            &lt;value&gt;socks5://127.0.0.1:23456&lt;/value&gt;
        &lt;/setting&gt;
        &lt;setting&gt;
            &lt;name&gt;chaining.socks5.methods&lt;/name&gt;
            &lt;socks5.methods&gt;
                &lt;socks5.method&gt;USERNAME_PASSWORD&lt;/socks5.method&gt;
            &lt;/socks5.methods&gt;
        &lt;/setting&gt;
        &lt;setting&gt;
            &lt;name&gt;chaining.socks5.userpassmethod.username&lt;/name&gt;
            &lt;value&gt;Aladdin&lt;/value&gt;
        &lt;/setting&gt;
        &lt;setting&gt;
            &lt;name&gt;chaining.socks5.userpassmethod.password&lt;/name&gt;
            &lt;value&gt;opensesame&lt;/value&gt;
            &lt;doc&gt;If this configuration file was created by new-server-config-file, the password would be encrypted&lt;/doc&gt;
        &lt;/setting&gt;
    &lt;/settings&gt;
&lt;/configuration&gt;
</code></pre></div>
<p>If you do not want to have the password appear in any script or in any part of
the command line history for security reasons, you can use the command line
option <code>--enter-chaining-socks5-userpassmethod-pass</code> instead. It will
provide an interactive prompt for you to enter the password.</p>
<p>Command line example:</p>

<div class="verbatim">
<pre><code class="language-bash">jargyle start-server \
    --setting=chaining.socksServerUri=socks5://127.0.0.1:23456 \
    --setting=chaining.socks5.methods=USERNAME_PASSWORD \
    --setting=chaining.socks5.userpassmethod.username=Aladdin \
    --enter-chaining-socks5-userpassmethod-pass
</code></pre></div></section><section>
<h4>Chaining to the Other SOCKS Server Using GSS-API Authentication</h4>
<p>To chain to the other SOCKS server using GSS-API authentication, you will need
to have the setting <code>chaining.socks5.methods</code> to have <code>GSSAPI</code> included.
You will also need to specify Java system properties to use a security
mechanism that implements the GSS-API (for example, Kerberos is a security
mechanism that implements the GSS-API) and you will also need to specify the
GSS-API service name for the other SOCKS5 server.</p>
<p>The following are sufficient examples of using the Kerberos security mechanism:</p>
<p>API example:</p>

<div class="verbatim">
<pre><code class="language-java">package com.example;

import com.github.jh3nd3rs0n.jargyle.server.Configuration;
import com.github.jh3nd3rs0n.jargyle.server.Setting;
import com.github.jh3nd3rs0n.jargyle.server.Settings;
import com.github.jh3nd3rs0n.jargyle.server.SocksServer;

import java.io.IOException;

public class ServerApp {
    public static void main(String[] args) throws IOException {
        System.setProperty(
            &quot;javax.security.auth.useSubjectCredsOnly&quot;, &quot;false&quot;);
        System.setProperty(
            &quot;java.security.auth.login.config&quot;, &quot;login.conf&quot;);
        System.setProperty(&quot;java.security.krb5.conf&quot;, &quot;krb5.conf&quot;);
        new SocksServer(Configuration.newUnmodifiableInstance(Settings.of(
            Setting.newInstanceWithParsedValue(
                &quot;chaining.socksServerUri&quot;, 
                &quot;socks5://127.0.0.1:23456&quot;),
            Setting.newInstanceWithParsedValue(
                &quot;chaining.socks5.methods&quot;, &quot;GSSAPI&quot;),
            Setting.newInstanceWithParsedValue(
                &quot;chaining.socks5.gssapimethod.serviceName&quot;,
                &quot;rcmd/127.0.0.1&quot;)
        ))).start();
    }
}
</code></pre></div>
<p>Command line example:</p>

<div class="verbatim">
<pre><code class="language-bash">export JARGYLE_OPTS=&quot;-Djavax.security.auth.useSubjectCredsOnly=false -Djava.security.auth.login.config=login.conf -Djava.security.krb5.conf=krb5.conf&quot;
jargyle start-server \
    --setting=chaining.socksServerUri=socks5://127.0.0.1:23456 \
    --setting=chaining.socks5.methods=GSSAPI \
    --setting=chaining.socks5.gssapimethod.serviceName=rcmd/127.0.0.1 
</code></pre></div>
<p>Server configuration file example:</p>

<div class="verbatim">
<pre><code class="language-xml">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot; standalone=&quot;yes&quot;?&gt;
&lt;configuration&gt;
&lt;!--
Before running this file, the following must be executed:
export JARGYLE_OPTS=&quot;-Djavax.security.auth.useSubjectCredsOnly=false -Djava.security.auth.login.config=login.conf -Djava.security.krb5.conf=krb5.conf&quot;
--&gt;
    &lt;settings&gt;
        &lt;setting&gt;
            &lt;name&gt;chaining.socksServerUri&lt;/name&gt;
            &lt;value&gt;socks5://127.0.0.1:23456&lt;/value&gt;
        &lt;/setting&gt;
        &lt;setting&gt;
            &lt;name&gt;chaining.socks5.methods&lt;/name&gt;
            &lt;socks5.methods&gt;
                &lt;socks5.method&gt;GSSAPI&lt;/socks5.method&gt;
            &lt;/socks5.methods&gt;
        &lt;/setting&gt;
        &lt;setting&gt;
            &lt;name&gt;chaining.socks5.gssapimethod.serviceName&lt;/name&gt;
            &lt;value&gt;rcmd/127.0.0.1&lt;/value&gt;
        &lt;/setting&gt;
    &lt;/settings&gt;
&lt;/configuration&gt;
</code></pre></div>
<p>The Java system property <code>javax.security.auth.useSubjectCredsOnly</code> with
the value <code>false</code> disables JAAS-based authentication to obtain the credentials
directly and lets the underlying security mechanism obtain them instead.</p>
<p>The Java system property <code>java.security.auth.login.config</code> with the value
<code>login.conf</code> provides a JAAS configuration file for the underlying security
mechanism.</p>
<p><code>login.conf</code>:</p>

<div class="verbatim">
<pre><code class="language-text">com.sun.security.jgss.initiate {
  com.sun.security.auth.module.Krb5LoginModule required
  principal=&quot;alice&quot;
  useKeyTab=true
  keyTab=&quot;alice.keytab&quot;
  storeKey=true;
};
</code></pre></div>
<p>In <code>login.conf</code>, <code>alice</code> is a principal that is created by a Kerberos
administrator.</p>
<p>Also in <code>login.conf</code>, <code>alice.keytab</code> is a keytab file also created by a
Kerberos administrator that contains the aforementioned principal and its
respective encrypted key.</p>
<p>The Java system property <code>java.security.krb5.conf</code> with the value
<code>krb5.conf</code> provides the Kerberos configuration file that points to the
Kerberos Key Distribution Center (KDC) for authentication.</p>
<p><code>krb5.conf</code>:</p>

<div class="verbatim">
<pre><code class="language-text">[libdefaults]
    kdc_realm = EXAMPLE.COM
    default_realm = EXAMPLE.COM
    udp_preference_limit = 4096
    kdc_tcp_port = 12345
    kdc_udp_port = 12345

[realms]
    EXAMPLE.COM = {
        kdc = 127.0.0.1:12345
    }
</code></pre></div>
<p>In <code>krb5.conf</code>, a KDC is defined as running at the address <code>127.0.0.1</code> on
port <code>12345</code> with its realm as <code>EXAMPLE.COM</code>. (In a production environment,
the address <code>127.0.0.1</code> should be replaced by the actual address or name of
the machine of where the KDC resides. Also, in a production environment, the
realm <code>EXAMPLE.COM</code> should be replaced by an actual realm provided by a
Kerberos administrator.)</p>
<p>The setting <code>chaining.socks5.gssapimethod.serviceName</code> with the value
<code>rcmd/127.0.0.1</code> is the GSS-API service name (or the Kerberos service
principal) for the other SOCKS server residing at the address <code>127.0.0.1</code>. (In
a production environment, the address <code>127.0.0.1</code> should be replaced by the
name of the machine of where the other SOCKS server resides.)</p></section></section><section>
<h3>Resolving Host Names From the Other SOCKS5 Server</h3>
<p>Before discussing host name resolution from the other SOCKS5 server, a brief
explanation of the server's internals:</p>
<p>The server uses sockets to interact with the external world.</p>
<ul>

<li>Under the CONNECT request, it uses a socket that connects to the desired
target server. In this documentation, this socket is called the target-facing
socket.</li>
<li>Under the BIND request, it uses a socket that listens for an inbound socket.
In this documentation, this socket is called the listen socket.</li>
<li>Under the UDP ASSOCIATE request, it uses a UDP socket that sends and
receives datagram packets to and from peer UDP sockets. In this documentation,
this UDP socket is called the peer-facing UDP socket.</li>
</ul>
<p>The server also uses a host resolver to resolve host names for the
aforementioned sockets and for
<a href="../reference/socks5-resolve-request.html">the RESOLVE request</a>.</p>
<p>When the server is chained to another SOCKS5 server, the aforementioned sockets
that the server uses become SOCKS5-enabled, meaning that their traffic is routed
through the other SOCKS5 server.</p>
<p>It is similar for the host resolver. When the server is chained to another
SOCKS5 server, the host resolver that the server uses becomes SOCKS5-enabled,
meaning that it can use the other SOCKS5 server to resolve host names provided
that the other SOCKS5 server supports handling the SOCKS5 RESOLVE request.
However, this functionality for the host resolver is disabled by default
making the host resolver resolve host names through the local system.</p>
<p>Therefore, default host name resolution from the other SOCKS5 server is
performed but has the following limitations:</p>
<p>Default host name resolution from the other SOCKS5 server OCCURS ONLY&#x2026;</p>
<ul>

<li>&#x2026;under the CONNECT request when the target-facing socket makes an
extemporaneous outbound connection. Preparation is omitted for the target-facing
socket. Such preparation includes applying the specified socket settings for the
target-facing socket, resolving the target host name before connecting, and
setting the specified timeout in milliseconds on waiting for the target-facing
socket to connect. The host resolver is not used in resolving the target host
name. When the target-facing socket is SOCKS5-enabled, the target host name is
resolved by the other SOCKS5 server and not through the local system.</li>
</ul>
<p>Default host name resolution from the other SOCKS5 server DOES NOT OCCUR&#x2026;</p>
<ul>

<li>&#x2026;under the CONNECT request when the target-facing socket makes a prepared
outbound connection. Preparation for the target-facing socket includes resolving
the target host name before connecting. The host resolver is used in resolving
the target host name. Because of its default functionality, the host resolver
resolves the target host name through the local system.</li>
<li>&#x2026;under the BIND request when resolving the binding host name for the
listen socket. The host resolver is used in resolving the binding host name for
the listen socket. Because of its default functionality, the host resolver
resolves the binding host name for the listen socket through the local system.</li>
<li>&#x2026;under the UDP ASSOCIATE request when resolving the host name for an
outbound datagram packet. The host resolver is used in resolving the host name
for an outbound datagram packet. Because of its default functionality, the host
resolver resolves the host name for an outbound datagram packet through the
local system.</li>
<li>&#x2026;under the RESOLVE request when resolving the provided host name. The host
resolver is used in resolving the provided host name. Because of its default
functionality, the host resolver resolves the provided host name through the
local system.</li>
</ul>
<p>If you prefer to have host name resolution from the other SOCKS5 server without
the aforementioned limitations, you would need to set the setting
<code>chaining.socks5.socks5HostResolver.resolveFromSocks5Server</code> to <code>true</code>. This
setting enables the host resolver to resolve host names from the other SOCKS5
server. This setting can only be used if the other SOCKS5 server supports
handling the RESOLVE request.</p>
<p>API example:</p>

<div class="verbatim">
<pre><code class="language-java">package com.example;

import com.github.jh3nd3rs0n.jargyle.server.Configuration;
import com.github.jh3nd3rs0n.jargyle.server.Setting;
import com.github.jh3nd3rs0n.jargyle.server.Settings;
import com.github.jh3nd3rs0n.jargyle.server.SocksServer;

import java.io.IOException;

public class ServerApp {
    public static void main(String[] args) throws IOException {
        new SocksServer(Configuration.newUnmodifiableInstance(Settings.of(
            Setting.newInstanceWithParsedValue(
                &quot;chaining.socksServerUri&quot;, 
                &quot;socks5://127.0.0.1:23456&quot;),
            Setting.newInstanceWithParsedValue(
                &quot;chaining.socks5.socks5HostResolver.resolveFromSocks5Server&quot;, 
                &quot;true&quot;)
        ))).start();
    }
}
</code></pre></div>
<p>Command line example:</p>

<div class="verbatim">
<pre><code class="language-bash">jargyle start-server \
    --setting=chaining.socksServerUri=socks5://127.0.0.1:23456 \
    --setting=chaining.socks5.socks5HostResolver.resolveFromSocks5Server=true
</code></pre></div>
<p>Server configuration file example:</p>

<div class="verbatim">
<pre><code class="language-xml">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot; standalone=&quot;yes&quot;?&gt;
&lt;configuration&gt;
    &lt;settings&gt;
        &lt;setting&gt;
            &lt;name&gt;chaining.socksServerUri&lt;/name&gt;
            &lt;value&gt;socks5://127.0.0.1:23456&lt;/value&gt;
        &lt;/setting&gt;
        &lt;setting&gt;
            &lt;name&gt;chaining.socks5.socks5HostResolver.resolveFromSocks5Server&lt;/name&gt;
            &lt;value&gt;true&lt;/value&gt;
        &lt;/setting&gt;
    &lt;/settings&gt;
&lt;/configuration&gt;
</code></pre></div></section></section><section>
<h2>Chaining to a Specified Chain of Other SOCKS Servers</h2>
<p>You can have the server chained to a specified chain of other SOCKS servers,
meaning that its traffic can be routed through the specified chain of the other
SOCKS servers. To have the server chained to a specified chain of other SOCKS
servers, you will need to have the setting <code>chaining.socksServerUri</code>
specified multiple times with each setting specifying a SOCKS server as a URI.</p>
<p>API example:</p>

<div class="verbatim">
<pre><code class="language-java">package com.example;

import com.github.jh3nd3rs0n.jargyle.server.Configuration;
import com.github.jh3nd3rs0n.jargyle.server.Setting;
import com.github.jh3nd3rs0n.jargyle.server.Settings;
import com.github.jh3nd3rs0n.jargyle.server.SocksServer;

import java.io.IOException;

public class ServerApp {
    public static void main(String[] args) throws IOException {
        new SocksServer(Configuration.newUnmodifiableInstance(Settings.of(
            Setting.newInstanceWithParsedValue(
                &quot;chaining.socksServerUri&quot;, 
                &quot;socks5://127.0.0.1:23456&quot;),
            Setting.newInstanceWithParsedValue(
                &quot;chaining.socksServerUri&quot;, 
                &quot;socks5://127.0.0.1:65432&quot;),
            Setting.newInstanceWithParsedValue(
                &quot;chaining.socksServerUri&quot;, 
                &quot;socks5://127.0.0.1:34567&quot;)
        ))).start();
    }
}
</code></pre></div>
<p>Command line example:</p>

<div class="verbatim">
<pre><code class="language-bash">jargyle start-server \
    --setting=chaining.socksServerUri=socks5://127.0.0.1:23456 \
    --setting=chaining.socksServerUri=socks5://127.0.0.1:65432 \
    --setting=chaining.socksServerUri=socks5://127.0.0.1:34567
</code></pre></div>
<p>Server configuration file example:</p>

<div class="verbatim">
<pre><code class="language-xml">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot; standalone=&quot;yes&quot;?&gt;
&lt;configuration&gt;
    &lt;settings&gt;
        &lt;setting&gt;
            &lt;name&gt;chaining.socksServerUri&lt;/name&gt;
            &lt;value&gt;socks5://127.0.0.1:23456&lt;/value&gt;
        &lt;/setting&gt;
        &lt;setting&gt;
            &lt;name&gt;chaining.socksServerUri&lt;/name&gt;
            &lt;value&gt;socks5://127.0.0.1:65432&lt;/value&gt;
        &lt;/setting&gt;
        &lt;setting&gt;
            &lt;name&gt;chaining.socksServerUri&lt;/name&gt;
            &lt;value&gt;socks5://127.0.0.1:34567&lt;/value&gt;
        &lt;/setting&gt;
    &lt;/settings&gt;
&lt;/configuration&gt;
</code></pre></div>
<p>To specify the settings regarding a SOCKS server in the chain, the settings
regarding a SOCKS server will need to be placed after that specified SOCKS
server but before the next specified SOCKS server if any.</p>
<p>API example:</p>

<div class="verbatim">
<pre><code class="language-java">package com.example;

import com.github.jh3nd3rs0n.jargyle.server.Configuration;
import com.github.jh3nd3rs0n.jargyle.server.Setting;
import com.github.jh3nd3rs0n.jargyle.server.Settings;
import com.github.jh3nd3rs0n.jargyle.server.SocksServer;

import java.io.IOException;

public class ServerApp {
    public static void main(String[] args) throws IOException {
        new SocksServer(Configuration.newUnmodifiableInstance(Settings.of(
            Setting.newInstanceWithParsedValue(
                &quot;chaining.socksServerUri&quot;, 
                &quot;socks5://127.0.0.1:23456&quot;),
            Setting.newInstanceWithParsedValue(
                &quot;chaining.socks5.methods&quot;, &quot;GSSAPI&quot;),
            Setting.newInstanceWithParsedValue(
                &quot;chaining.socks5.gssapimethod.serviceName&quot;,
                &quot;rcmd/127.0.0.1&quot;),
            Setting.newInstanceWithParsedValue(
                &quot;chaining.socksServerUri&quot;, 
                &quot;socks5://127.0.0.1:65432&quot;),
            Setting.newInstanceWithParsedValue(
                &quot;chaining.socks5.methods&quot;, &quot;USERNAME_PASSWORD&quot;),
            Setting.newInstanceWithParsedValue(
                &quot;chaining.socks5.userpassmethod.username&quot;,
                &quot;Aladdin&quot;),
            Setting.newInstanceWithParsedValue(
                &quot;chaining.socks5.userpassmethod.password&quot;,
                &quot;opensesame&quot;),
            Setting.newInstanceWithParsedValue(
                &quot;chaining.socksServerUri&quot;, 
                &quot;socks5://127.0.0.1:34567&quot;),
            Setting.newInstanceWithParsedValue(
                &quot;chaining.socks5.socks5HostResolver.resolveFromSocks5Server&quot;, 
                &quot;true&quot;)
        ))).start();
    }
}
</code></pre></div>
<p>Command line example:</p>

<div class="verbatim">
<pre><code class="language-bash">jargyle start-server \
    --setting=chaining.socksServerUri=socks5://127.0.0.1:23456 \
    --setting=chaining.socks5.methods=GSSAPI \
    --setting=chaining.socks5.gssapimethod.serviceName=rcmd/127.0.0.1 \
    --setting=chaining.socksServerUri=socks5://127.0.0.1:65432 \
    --setting=chaining.socks5.methods=USERNAME_PASSWORD \
    --setting=chaining.socks5.userpassmethod.username=Aladdin \
    --setting=chaining.socks5.userpassmethod.password=opensesame \
    --setting=chaining.socksServerUri=socks5://127.0.0.1:34567 \
    --setting=chaining.socks5.socks5HostResolver.resolveFromSocks5Server=true
</code></pre></div>
<p>Server configuration file example:</p>

<div class="verbatim">
<pre><code class="language-xml">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot; standalone=&quot;yes&quot;?&gt;
&lt;configuration&gt;
    &lt;settings&gt;
        &lt;setting&gt;
            &lt;name&gt;chaining.socksServerUri&lt;/name&gt;
            &lt;value&gt;socks5://127.0.0.1:23456&lt;/value&gt;
        &lt;/setting&gt;
        &lt;setting&gt;
            &lt;name&gt;chaining.socks5.methods&lt;/name&gt;
            &lt;socks5.methods&gt;
                &lt;socks5.method&gt;GSSAPI&lt;/socks5.method&gt;
            &lt;/socks5.methods&gt;
        &lt;/setting&gt;
        &lt;setting&gt;
            &lt;name&gt;chaining.socks5.gssapimethod.serviceName&lt;/name&gt;
            &lt;value&gt;rcmd/127.0.0.1&lt;/value&gt;
        &lt;/setting&gt;
        &lt;setting&gt;
            &lt;name&gt;chaining.socksServerUri&lt;/name&gt;
            &lt;value&gt;socks5://127.0.0.1:65432&lt;/value&gt;
        &lt;/setting&gt;
        &lt;setting&gt;
            &lt;name&gt;chaining.socks5.methods&lt;/name&gt;
            &lt;socks5.methods&gt;
                &lt;socks5.method&gt;USERNAME_PASSWORD&lt;/socks5.method&gt;
            &lt;/socks5.methods&gt;
        &lt;/setting&gt;
        &lt;setting&gt;
            &lt;name&gt;chaining.socks5.userpassmethod.username&lt;/name&gt;
            &lt;value&gt;Aladdin&lt;/value&gt;
        &lt;/setting&gt;
        &lt;setting&gt;
            &lt;name&gt;chaining.socks5.userpassmethod.password&lt;/name&gt;
            &lt;value&gt;opensesame&lt;/value&gt;
            &lt;doc&gt;If this configuration file was created by new-server-config-file, the password would be encrypted&lt;/doc&gt;
        &lt;/setting&gt;
        &lt;setting&gt;
            &lt;name&gt;chaining.socksServerUri&lt;/name&gt;
            &lt;value&gt;socks5://127.0.0.1:34567&lt;/value&gt;
        &lt;/setting&gt;        
        &lt;setting&gt;
            &lt;name&gt;chaining.socks5.socks5HostResolver.resolveFromSocks5Server&lt;/name&gt;
            &lt;value&gt;true&lt;/value&gt;
        &lt;/setting&gt;    
    &lt;/settings&gt;
&lt;/configuration&gt;
</code></pre></div>
<p>The known limitations of chaining to a specified chain of other SOCKS servers
include the following:</p>
<ul>

<li>Only TCP traffic can be routed through the chain. The server will attempt to
route any UDP traffic through the last SOCKS server of the chain.</li>
</ul></section><section>
<h2>Chaining to Specified Chains of Other SOCKS Servers</h2>
<p>You can have the server chained to specified chains of other SOCKS servers,
meaning that its traffic can be routed through one of the specified chains of
other SOCKS servers at a time. To have the server chained to multiple
specified chains of other SOCKS servers, you will need to have a route ID
assigned at the end of each
<a href="#chaining-to-a-specified-chain-of-other-socks-servers">chain</a> by using the
setting <code>chaining.routeId</code></p>
<p>API example:</p>

<div class="verbatim">
<pre><code class="language-java">package com.example;

import com.github.jh3nd3rs0n.jargyle.server.Configuration;
import com.github.jh3nd3rs0n.jargyle.server.Setting;
import com.github.jh3nd3rs0n.jargyle.server.Settings;
import com.github.jh3nd3rs0n.jargyle.server.SocksServer;

import java.io.IOException;

public class ServerApp {
    public static void main(String[] args) throws IOException {
        new SocksServer(Configuration.newUnmodifiableInstance(Settings.of(
            Setting.newInstanceWithParsedValue(
                &quot;chaining.socksServerUri&quot;, 
                &quot;socks5://127.0.0.1:11111&quot;),
            Setting.newInstanceWithParsedValue(
                &quot;chaining.socksServerUri&quot;, 
                &quot;socks5://127.0.0.1:11112&quot;),
            Setting.newInstanceWithParsedValue(
                &quot;chaining.socksServerUri&quot;, 
                &quot;socks5://127.0.0.1:11113&quot;),
            Setting.newInstanceWithParsedValue(
                &quot;chaining.routeId&quot;, &quot;alpha&quot;),
            Setting.newInstanceWithParsedValue(
                &quot;chaining.socksServerUri&quot;, 
                &quot;socks5://127.0.0.1:22221&quot;),
            Setting.newInstanceWithParsedValue(
                &quot;chaining.socksServerUri&quot;, 
                &quot;socks5://127.0.0.1:22222&quot;),
            Setting.newInstanceWithParsedValue(
                &quot;chaining.socksServerUri&quot;, 
                &quot;socks5://127.0.0.1:22223&quot;),
            Setting.newInstanceWithParsedValue(
                &quot;chaining.routeId&quot;, &quot;beta&quot;),
            Setting.newInstanceWithParsedValue(
                &quot;chaining.socksServerUri&quot;, 
                &quot;socks5://127.0.0.1:33331&quot;),
            Setting.newInstanceWithParsedValue(
                &quot;chaining.socksServerUri&quot;, 
                &quot;socks5://127.0.0.1:33332&quot;),
            Setting.newInstanceWithParsedValue(
                &quot;chaining.socksServerUri&quot;, 
                &quot;socks5://127.0.0.1:33333&quot;),
            Setting.newInstanceWithParsedValue(
                &quot;chaining.routeId&quot;, &quot;delta&quot;)
        ))).start();
    }
}
</code></pre></div>
<p>Command line example:</p>

<div class="verbatim">
<pre><code class="language-bash">jargyle start-server \
    --setting=chaining.socksServerUri=socks5://127.0.0.1:11111 \
    --setting=chaining.socksServerUri=socks5://127.0.0.1:11112 \
    --setting=chaining.socksServerUri=socks5://127.0.0.1:11113 \
    --setting=chaining.routeId=alpha \
    --setting=chaining.socksServerUri=socks5://127.0.0.1:22221 \
    --setting=chaining.socksServerUri=socks5://127.0.0.1:22222 \
    --setting=chaining.socksServerUri=socks5://127.0.0.1:22223 \
    --setting=chaining.routeId=beta \
    --setting=chaining.socksServerUri=socks5://127.0.0.1:33331 \
    --setting=chaining.socksServerUri=socks5://127.0.0.1:33332 \
    --setting=chaining.socksServerUri=socks5://127.0.0.1:33333 \
    --setting=chaining.routeId=delta
</code></pre></div>
<p>Server configuration file example:</p>

<div class="verbatim">
<pre><code class="language-xml">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot; standalone=&quot;yes&quot;?&gt;
&lt;configuration&gt;
    &lt;settings&gt;
        &lt;setting&gt;
            &lt;name&gt;chaining.socksServerUri&lt;/name&gt;
            &lt;value&gt;socks5://127.0.0.1:11111&lt;/value&gt;
        &lt;/setting&gt;
        &lt;setting&gt;
            &lt;name&gt;chaining.socksServerUri&lt;/name&gt;
            &lt;value&gt;socks5://127.0.0.1:11112&lt;/value&gt;
        &lt;/setting&gt;
        &lt;setting&gt;
            &lt;name&gt;chaining.socksServerUri&lt;/name&gt;
            &lt;value&gt;socks5://127.0.0.1:11113&lt;/value&gt;
        &lt;/setting&gt;
        &lt;setting&gt;
            &lt;name&gt;chaining.routeId&lt;/name&gt;
            &lt;value&gt;alpha&lt;/value&gt;
        &lt;/setting&gt;
        &lt;setting&gt;
            &lt;name&gt;chaining.socksServerUri&lt;/name&gt;
            &lt;value&gt;socks5://127.0.0.1:22221&lt;/value&gt;
        &lt;/setting&gt;
        &lt;setting&gt;
            &lt;name&gt;chaining.socksServerUri&lt;/name&gt;
            &lt;value&gt;socks5://127.0.0.1:22222&lt;/value&gt;
        &lt;/setting&gt;
        &lt;setting&gt;
            &lt;name&gt;chaining.socksServerUri&lt;/name&gt;
            &lt;value&gt;socks5://127.0.0.1:22223&lt;/value&gt;
        &lt;/setting&gt;
        &lt;setting&gt;
            &lt;name&gt;chaining.routeId&lt;/name&gt;
            &lt;value&gt;beta&lt;/value&gt;
        &lt;/setting&gt;
        &lt;setting&gt;
            &lt;name&gt;chaining.socksServerUri&lt;/name&gt;
            &lt;value&gt;socks5://127.0.0.1:33331&lt;/value&gt;
        &lt;/setting&gt;
        &lt;setting&gt;
            &lt;name&gt;chaining.socksServerUri&lt;/name&gt;
            &lt;value&gt;socks5://127.0.0.1:33332&lt;/value&gt;
        &lt;/setting&gt;
        &lt;setting&gt;
            &lt;name&gt;chaining.socksServerUri&lt;/name&gt;
            &lt;value&gt;socks5://127.0.0.1:33333&lt;/value&gt;
        &lt;/setting&gt;
        &lt;setting&gt;
            &lt;name&gt;chaining.routeId&lt;/name&gt;
            &lt;value&gt;delta&lt;/value&gt;
        &lt;/setting&gt;
    &lt;/settings&gt;
&lt;/configuration&gt;
</code></pre></div>
<p>From the aforementioned examples:</p>
<ul>

<li>The chain consisting of <code>socks5://127.0.0.1:11111</code>,
<code>socks5://127.0.0.1:11112</code>, and <code>socks5://127.0.0.1:11113</code> is assigned
the route ID of <code>alpha</code></li>
<li>The chain consisting of <code>socks5://127.0.0.1:22221</code>,
<code>socks5://127.0.0.1:22222</code>, and <code>socks5://127.0.0.1:22223</code> is assigned
the route ID of <code>beta</code></li>
<li>The chain consisting of <code>socks5://127.0.0.1:33331</code>,
<code>socks5://127.0.0.1:33332</code>, and <code>socks5://127.0.0.1:33333</code> is assigned
the route ID of <code>delta</code></li>
</ul>
<p>There is another route that is assigned a route ID. That route is the direct
route. The direct route uses no chain to route the traffic through. It is
assigned by default a route ID of <code>lastRoute</code>.</p>
<p>To omit the direct route from being included, have the last chain not assigned a
route ID from the setting <code>chaining.routeId</code>.</p>
<p>API example:</p>

<div class="verbatim">
<pre><code class="language-java">package com.example;

import com.github.jh3nd3rs0n.jargyle.server.Configuration;
import com.github.jh3nd3rs0n.jargyle.server.Setting;
import com.github.jh3nd3rs0n.jargyle.server.Settings;
import com.github.jh3nd3rs0n.jargyle.server.SocksServer;

import java.io.IOException;

public class ServerApp {
    public static void main(String[] args) throws IOException {
        new SocksServer(Configuration.newUnmodifiableInstance(Settings.of(
            Setting.newInstanceWithParsedValue(
                &quot;chaining.socksServerUri&quot;, 
                &quot;socks5://127.0.0.1:11111&quot;),
            Setting.newInstanceWithParsedValue(
                &quot;chaining.socksServerUri&quot;, 
                &quot;socks5://127.0.0.1:11112&quot;),
            Setting.newInstanceWithParsedValue(
                &quot;chaining.socksServerUri&quot;, 
                &quot;socks5://127.0.0.1:11113&quot;),
            Setting.newInstanceWithParsedValue(
                &quot;chaining.routeId&quot;, &quot;alpha&quot;),
            Setting.newInstanceWithParsedValue(
                &quot;chaining.socksServerUri&quot;, 
                &quot;socks5://127.0.0.1:22221&quot;),
            Setting.newInstanceWithParsedValue(
                &quot;chaining.socksServerUri&quot;, 
                &quot;socks5://127.0.0.1:22222&quot;),
            Setting.newInstanceWithParsedValue(
                &quot;chaining.socksServerUri&quot;, 
                &quot;socks5://127.0.0.1:22223&quot;),
            Setting.newInstanceWithParsedValue(
                &quot;chaining.routeId&quot;, &quot;beta&quot;),
            Setting.newInstanceWithParsedValue(
                &quot;chaining.socksServerUri&quot;, 
                &quot;socks5://127.0.0.1:33331&quot;),
            Setting.newInstanceWithParsedValue(
                &quot;chaining.socksServerUri&quot;, 
                &quot;socks5://127.0.0.1:33332&quot;),
            Setting.newInstanceWithParsedValue(
                &quot;chaining.socksServerUri&quot;, 
                &quot;socks5://127.0.0.1:33333&quot;)
        ))).start();
    }
}
</code></pre></div>
<p>Command line example:</p>

<div class="verbatim">
<pre><code class="language-bash">jargyle start-server \
    --setting=chaining.socksServerUri=socks5://127.0.0.1:11111 \
    --setting=chaining.socksServerUri=socks5://127.0.0.1:11112 \
    --setting=chaining.socksServerUri=socks5://127.0.0.1:11113 \
    --setting=chaining.routeId=alpha \
    --setting=chaining.socksServerUri=socks5://127.0.0.1:22221 \
    --setting=chaining.socksServerUri=socks5://127.0.0.1:22222 \
    --setting=chaining.socksServerUri=socks5://127.0.0.1:22223 \
    --setting=chaining.routeId=beta \
    --setting=chaining.socksServerUri=socks5://127.0.0.1:33331 \
    --setting=chaining.socksServerUri=socks5://127.0.0.1:33332 \
    --setting=chaining.socksServerUri=socks5://127.0.0.1:33333
</code></pre></div>
<p>Server configuration file example:</p>

<div class="verbatim">
<pre><code class="language-xml">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot; standalone=&quot;yes&quot;?&gt;
&lt;configuration&gt;
    &lt;settings&gt;
        &lt;setting&gt;
            &lt;name&gt;chaining.socksServerUri&lt;/name&gt;
            &lt;value&gt;socks5://127.0.0.1:11111&lt;/value&gt;
        &lt;/setting&gt;
        &lt;setting&gt;
            &lt;name&gt;chaining.socksServerUri&lt;/name&gt;
            &lt;value&gt;socks5://127.0.0.1:11112&lt;/value&gt;
        &lt;/setting&gt;
        &lt;setting&gt;
            &lt;name&gt;chaining.socksServerUri&lt;/name&gt;
            &lt;value&gt;socks5://127.0.0.1:11113&lt;/value&gt;
        &lt;/setting&gt;
        &lt;setting&gt;
            &lt;name&gt;chaining.routeId&lt;/name&gt;
            &lt;value&gt;alpha&lt;/value&gt;
        &lt;/setting&gt;
        &lt;setting&gt;
            &lt;name&gt;chaining.socksServerUri&lt;/name&gt;
            &lt;value&gt;socks5://127.0.0.1:22221&lt;/value&gt;
        &lt;/setting&gt;
        &lt;setting&gt;
            &lt;name&gt;chaining.socksServerUri&lt;/name&gt;
            &lt;value&gt;socks5://127.0.0.1:22222&lt;/value&gt;
        &lt;/setting&gt;
        &lt;setting&gt;
            &lt;name&gt;chaining.socksServerUri&lt;/name&gt;
            &lt;value&gt;socks5://127.0.0.1:22223&lt;/value&gt;
        &lt;/setting&gt;
        &lt;setting&gt;
            &lt;name&gt;chaining.routeId&lt;/name&gt;
            &lt;value&gt;beta&lt;/value&gt;
        &lt;/setting&gt;
        &lt;setting&gt;
            &lt;name&gt;chaining.socksServerUri&lt;/name&gt;
            &lt;value&gt;socks5://127.0.0.1:33331&lt;/value&gt;
        &lt;/setting&gt;
        &lt;setting&gt;
            &lt;name&gt;chaining.socksServerUri&lt;/name&gt;
            &lt;value&gt;socks5://127.0.0.1:33332&lt;/value&gt;
        &lt;/setting&gt;
        &lt;setting&gt;
            &lt;name&gt;chaining.socksServerUri&lt;/name&gt;
            &lt;value&gt;socks5://127.0.0.1:33333&lt;/value&gt;
        &lt;/setting&gt;
    &lt;/settings&gt;
&lt;/configuration&gt;
</code></pre></div>
<p>From the aforementioned examples:</p>
<ul>

<li>The chain consisting of <code>socks5://127.0.0.1:11111</code>,
<code>socks5://127.0.0.1:11112</code>, and <code>socks5://127.0.0.1:11113</code> is assigned
the route ID of <code>alpha</code></li>
<li>The chain consisting of <code>socks5://127.0.0.1:22221</code>,
<code>socks5://127.0.0.1:22222</code>, and <code>socks5://127.0.0.1:22223</code> is assigned
the route ID of <code>beta</code></li>
<li>The chain consisting of <code>socks5://127.0.0.1:33331</code>,
<code>socks5://127.0.0.1:33332</code>, and <code>socks5://127.0.0.1:33333</code> is assigned
by default the route ID of <code>lastRoute</code></li>
</ul>
<p>To change the route ID assigned to the last route, you can set the setting
<code>lastRouteId</code> to the route ID you want assigned to the last route.</p>
<p>API example:</p>

<div class="verbatim">
<pre><code class="language-java">package com.example;

import com.github.jh3nd3rs0n.jargyle.server.Configuration;
import com.github.jh3nd3rs0n.jargyle.server.Setting;
import com.github.jh3nd3rs0n.jargyle.server.Settings;
import com.github.jh3nd3rs0n.jargyle.server.SocksServer;

import java.io.IOException;

public class ServerApp {
    public static void main(String[] args) throws IOException {
        new SocksServer(Configuration.newUnmodifiableInstance(Settings.of(
            Setting.newInstanceWithParsedValue(
                &quot;chaining.socksServerUri&quot;, 
                &quot;socks5://127.0.0.1:11111&quot;),
            Setting.newInstanceWithParsedValue(
                &quot;chaining.socksServerUri&quot;, 
                &quot;socks5://127.0.0.1:11112&quot;),
            Setting.newInstanceWithParsedValue(
                &quot;chaining.socksServerUri&quot;, 
                &quot;socks5://127.0.0.1:11113&quot;),
            Setting.newInstanceWithParsedValue(
                &quot;chaining.routeId&quot;, &quot;alpha&quot;),
            Setting.newInstanceWithParsedValue(
                &quot;chaining.socksServerUri&quot;, 
                &quot;socks5://127.0.0.1:22221&quot;),
            Setting.newInstanceWithParsedValue(
                &quot;chaining.socksServerUri&quot;, 
                &quot;socks5://127.0.0.1:22222&quot;),
            Setting.newInstanceWithParsedValue(
                &quot;chaining.socksServerUri&quot;, 
                &quot;socks5://127.0.0.1:22223&quot;),
            Setting.newInstanceWithParsedValue(
                &quot;chaining.routeId&quot;, &quot;beta&quot;),
            Setting.newInstanceWithParsedValue(
                &quot;chaining.socksServerUri&quot;, 
                &quot;socks5://127.0.0.1:33331&quot;),
            Setting.newInstanceWithParsedValue(
                &quot;chaining.socksServerUri&quot;, 
                &quot;socks5://127.0.0.1:33332&quot;),
            Setting.newInstanceWithParsedValue(
                &quot;chaining.socksServerUri&quot;, 
                &quot;socks5://127.0.0.1:33333&quot;),
            Setting.newInstanceWithParsedValue(
                &quot;lastRouteId&quot;, &quot;omega&quot;)
        ))).start();
    }
}
</code></pre></div>
<p>Command line example:</p>

<div class="verbatim">
<pre><code class="language-bash">jargyle start-server \
    --setting=chaining.socksServerUri=socks5://127.0.0.1:11111 \
    --setting=chaining.socksServerUri=socks5://127.0.0.1:11112 \
    --setting=chaining.socksServerUri=socks5://127.0.0.1:11113 \
    --setting=chaining.routeId=alpha \
    --setting=chaining.socksServerUri=socks5://127.0.0.1:22221 \
    --setting=chaining.socksServerUri=socks5://127.0.0.1:22222 \
    --setting=chaining.socksServerUri=socks5://127.0.0.1:22223 \
    --setting=chaining.routeId=beta \
    --setting=chaining.socksServerUri=socks5://127.0.0.1:33331 \
    --setting=chaining.socksServerUri=socks5://127.0.0.1:33332 \
    --setting=chaining.socksServerUri=socks5://127.0.0.1:33333 \
    --setting=lastRouteId=omega
</code></pre></div>
<p>Server configuration file example:</p>

<div class="verbatim">
<pre><code class="language-xml">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot; standalone=&quot;yes&quot;?&gt;
&lt;configuration&gt;
    &lt;settings&gt;
        &lt;setting&gt;
            &lt;name&gt;chaining.socksServerUri&lt;/name&gt;
            &lt;value&gt;socks5://127.0.0.1:11111&lt;/value&gt;
        &lt;/setting&gt;
        &lt;setting&gt;
            &lt;name&gt;chaining.socksServerUri&lt;/name&gt;
            &lt;value&gt;socks5://127.0.0.1:11112&lt;/value&gt;
        &lt;/setting&gt;
        &lt;setting&gt;
            &lt;name&gt;chaining.socksServerUri&lt;/name&gt;
            &lt;value&gt;socks5://127.0.0.1:11113&lt;/value&gt;
        &lt;/setting&gt;
        &lt;setting&gt;
            &lt;name&gt;chaining.routeId&lt;/name&gt;
            &lt;value&gt;alpha&lt;/value&gt;
        &lt;/setting&gt;
        &lt;setting&gt;
            &lt;name&gt;chaining.socksServerUri&lt;/name&gt;
            &lt;value&gt;socks5://127.0.0.1:22221&lt;/value&gt;
        &lt;/setting&gt;
        &lt;setting&gt;
            &lt;name&gt;chaining.socksServerUri&lt;/name&gt;
            &lt;value&gt;socks5://127.0.0.1:22222&lt;/value&gt;
        &lt;/setting&gt;
        &lt;setting&gt;
            &lt;name&gt;chaining.socksServerUri&lt;/name&gt;
            &lt;value&gt;socks5://127.0.0.1:22223&lt;/value&gt;
        &lt;/setting&gt;
        &lt;setting&gt;
            &lt;name&gt;chaining.routeId&lt;/name&gt;
            &lt;value&gt;beta&lt;/value&gt;
        &lt;/setting&gt;
        &lt;setting&gt;
            &lt;name&gt;chaining.socksServerUri&lt;/name&gt;
            &lt;value&gt;socks5://127.0.0.1:33331&lt;/value&gt;
        &lt;/setting&gt;
        &lt;setting&gt;
            &lt;name&gt;chaining.socksServerUri&lt;/name&gt;
            &lt;value&gt;socks5://127.0.0.1:33332&lt;/value&gt;
        &lt;/setting&gt;
        &lt;setting&gt;
            &lt;name&gt;chaining.socksServerUri&lt;/name&gt;
            &lt;value&gt;socks5://127.0.0.1:33333&lt;/value&gt;
        &lt;/setting&gt;
        &lt;setting&gt;
            &lt;name&gt;lastRouteId&lt;/name&gt;
            &lt;value&gt;omega&lt;/value&gt;
        &lt;/setting&gt;
    &lt;/settings&gt;
&lt;/configuration&gt;
</code></pre></div>
<p>You can also set the setting <code>routeSelectionStrategy</code> to specify the
selection strategy for the next route. The default is <code>CYCLICAL</code>.</p>
<p>API example:</p>

<div class="verbatim">
<pre><code class="language-java">package com.example;

import com.github.jh3nd3rs0n.jargyle.server.Configuration;
import com.github.jh3nd3rs0n.jargyle.server.Setting;
import com.github.jh3nd3rs0n.jargyle.server.Settings;
import com.github.jh3nd3rs0n.jargyle.server.SocksServer;

import java.io.IOException;

public class ServerApp {
    public static void main(String[] args) throws IOException {
        new SocksServer(Configuration.newUnmodifiableInstance(Settings.of(
            Setting.newInstanceWithParsedValue(
                &quot;chaining.socksServerUri&quot;, 
                &quot;socks5://127.0.0.1:11111&quot;),
            Setting.newInstanceWithParsedValue(
                &quot;chaining.socksServerUri&quot;, 
                &quot;socks5://127.0.0.1:11112&quot;),
            Setting.newInstanceWithParsedValue(
                &quot;chaining.socksServerUri&quot;, 
                &quot;socks5://127.0.0.1:11113&quot;),
            Setting.newInstanceWithParsedValue(
                &quot;chaining.routeId&quot;, &quot;alpha&quot;),
            Setting.newInstanceWithParsedValue(
                &quot;chaining.socksServerUri&quot;, 
                &quot;socks5://127.0.0.1:22221&quot;),
            Setting.newInstanceWithParsedValue(
                &quot;chaining.socksServerUri&quot;, 
                &quot;socks5://127.0.0.1:22222&quot;),
            Setting.newInstanceWithParsedValue(
                &quot;chaining.socksServerUri&quot;, 
                &quot;socks5://127.0.0.1:22223&quot;),
            Setting.newInstanceWithParsedValue(
                &quot;chaining.routeId&quot;, &quot;beta&quot;),
            Setting.newInstanceWithParsedValue(
                &quot;chaining.socksServerUri&quot;, 
                &quot;socks5://127.0.0.1:33331&quot;),
            Setting.newInstanceWithParsedValue(
                &quot;chaining.socksServerUri&quot;, 
                &quot;socks5://127.0.0.1:33332&quot;),
            Setting.newInstanceWithParsedValue(
                &quot;chaining.socksServerUri&quot;, 
                &quot;socks5://127.0.0.1:33333&quot;),
            Setting.newInstanceWithParsedValue(
                &quot;lastRouteId&quot;, &quot;omega&quot;),
            Setting.newInstanceWithParsedValue(
                &quot;routeSelectionStrategy&quot;, &quot;RANDOM&quot;)
        ))).start();
    }
}
</code></pre></div>
<p>Command line example:</p>

<div class="verbatim">
<pre><code class="language-bash">jargyle start-server \
    --setting=chaining.socksServerUri=socks5://127.0.0.1:11111 \
    --setting=chaining.socksServerUri=socks5://127.0.0.1:11112 \
    --setting=chaining.socksServerUri=socks5://127.0.0.1:11113 \
    --setting=chaining.routeId=alpha \
    --setting=chaining.socksServerUri=socks5://127.0.0.1:22221 \
    --setting=chaining.socksServerUri=socks5://127.0.0.1:22222 \
    --setting=chaining.socksServerUri=socks5://127.0.0.1:22223 \
    --setting=chaining.routeId=beta \
    --setting=chaining.socksServerUri=socks5://127.0.0.1:33331 \
    --setting=chaining.socksServerUri=socks5://127.0.0.1:33332 \
    --setting=chaining.socksServerUri=socks5://127.0.0.1:33333 \
    --setting=lastRouteId=omega \
    --setting=routeSelectionStrategy=RANDOM
</code></pre></div>
<p>Server configuration file example:</p>

<div class="verbatim">
<pre><code class="language-xml">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot; standalone=&quot;yes&quot;?&gt;
&lt;configuration&gt;
    &lt;settings&gt;
        &lt;setting&gt;
            &lt;name&gt;chaining.socksServerUri&lt;/name&gt;
            &lt;value&gt;socks5://127.0.0.1:11111&lt;/value&gt;
        &lt;/setting&gt;
        &lt;setting&gt;
            &lt;name&gt;chaining.socksServerUri&lt;/name&gt;
            &lt;value&gt;socks5://127.0.0.1:11112&lt;/value&gt;
        &lt;/setting&gt;
        &lt;setting&gt;
            &lt;name&gt;chaining.socksServerUri&lt;/name&gt;
            &lt;value&gt;socks5://127.0.0.1:11113&lt;/value&gt;
        &lt;/setting&gt;
        &lt;setting&gt;
            &lt;name&gt;chaining.routeId&lt;/name&gt;
            &lt;value&gt;alpha&lt;/value&gt;
        &lt;/setting&gt;
        &lt;setting&gt;
            &lt;name&gt;chaining.socksServerUri&lt;/name&gt;
            &lt;value&gt;socks5://127.0.0.1:22221&lt;/value&gt;
        &lt;/setting&gt;
        &lt;setting&gt;
            &lt;name&gt;chaining.socksServerUri&lt;/name&gt;
            &lt;value&gt;socks5://127.0.0.1:22222&lt;/value&gt;
        &lt;/setting&gt;
        &lt;setting&gt;
            &lt;name&gt;chaining.socksServerUri&lt;/name&gt;
            &lt;value&gt;socks5://127.0.0.1:22223&lt;/value&gt;
        &lt;/setting&gt;
        &lt;setting&gt;
            &lt;name&gt;chaining.routeId&lt;/name&gt;
            &lt;value&gt;beta&lt;/value&gt;
        &lt;/setting&gt;
        &lt;setting&gt;
            &lt;name&gt;chaining.socksServerUri&lt;/name&gt;
            &lt;value&gt;socks5://127.0.0.1:33331&lt;/value&gt;
        &lt;/setting&gt;
        &lt;setting&gt;
            &lt;name&gt;chaining.socksServerUri&lt;/name&gt;
            &lt;value&gt;socks5://127.0.0.1:33332&lt;/value&gt;
        &lt;/setting&gt;
        &lt;setting&gt;
            &lt;name&gt;chaining.socksServerUri&lt;/name&gt;
            &lt;value&gt;socks5://127.0.0.1:33333&lt;/value&gt;
        &lt;/setting&gt;
        &lt;setting&gt;
            &lt;name&gt;lastRouteId&lt;/name&gt;
            &lt;value&gt;omega&lt;/value&gt;
        &lt;/setting&gt;
        &lt;setting&gt;
            &lt;name&gt;routeSelectionStrategy&lt;/name&gt;
            &lt;value&gt;RANDOM&lt;/value&gt;
        &lt;/setting&gt;
    &lt;/settings&gt;
&lt;/configuration&gt;
</code></pre></div>
<p>You can also set the setting <code>routeSelectionLogAction</code> to specify the
logging action to take if a route is selected.</p>
<p>API example:</p>

<div class="verbatim">
<pre><code class="language-java">package com.example;

import com.github.jh3nd3rs0n.jargyle.server.Configuration;
import com.github.jh3nd3rs0n.jargyle.server.Setting;
import com.github.jh3nd3rs0n.jargyle.server.Settings;
import com.github.jh3nd3rs0n.jargyle.server.SocksServer;

import java.io.IOException;

public class ServerApp {
    public static void main(String[] args) throws IOException {
        new SocksServer(Configuration.newUnmodifiableInstance(Settings.of(
            Setting.newInstanceWithParsedValue(
                &quot;chaining.socksServerUri&quot;, 
                &quot;socks5://127.0.0.1:11111&quot;),
            Setting.newInstanceWithParsedValue(
                &quot;chaining.socksServerUri&quot;, 
                &quot;socks5://127.0.0.1:11112&quot;),
            Setting.newInstanceWithParsedValue(
                &quot;chaining.socksServerUri&quot;, 
                &quot;socks5://127.0.0.1:11113&quot;),
            Setting.newInstanceWithParsedValue(
                &quot;chaining.routeId&quot;, &quot;alpha&quot;),
            Setting.newInstanceWithParsedValue(
                &quot;chaining.socksServerUri&quot;, 
                &quot;socks5://127.0.0.1:22221&quot;),
            Setting.newInstanceWithParsedValue(
                &quot;chaining.socksServerUri&quot;, 
                &quot;socks5://127.0.0.1:22222&quot;),
            Setting.newInstanceWithParsedValue(
                &quot;chaining.socksServerUri&quot;, 
                &quot;socks5://127.0.0.1:22223&quot;),
            Setting.newInstanceWithParsedValue(
                &quot;chaining.routeId&quot;, &quot;beta&quot;),
            Setting.newInstanceWithParsedValue(
                &quot;chaining.socksServerUri&quot;, 
                &quot;socks5://127.0.0.1:33331&quot;),
            Setting.newInstanceWithParsedValue(
                &quot;chaining.socksServerUri&quot;, 
                &quot;socks5://127.0.0.1:33332&quot;),
            Setting.newInstanceWithParsedValue(
                &quot;chaining.socksServerUri&quot;, 
                &quot;socks5://127.0.0.1:33333&quot;),
            Setting.newInstanceWithParsedValue(
                &quot;lastRouteId&quot;, &quot;omega&quot;),
            Setting.newInstanceWithParsedValue(
                &quot;routeSelectionStrategy&quot;, &quot;RANDOM&quot;),
            Setting.newInstanceWithParsedValue(
                &quot;routeSelectionLogAction&quot;, &quot;LOG_AS_INFO&quot;)
        ))).start();
    }
}
</code></pre></div>
<p>Command line example:</p>

<div class="verbatim">
<pre><code class="language-bash">jargyle start-server \
    --setting=chaining.socksServerUri=socks5://127.0.0.1:11111 \
    --setting=chaining.socksServerUri=socks5://127.0.0.1:11112 \
    --setting=chaining.socksServerUri=socks5://127.0.0.1:11113 \
    --setting=chaining.routeId=alpha \
    --setting=chaining.socksServerUri=socks5://127.0.0.1:22221 \
    --setting=chaining.socksServerUri=socks5://127.0.0.1:22222 \
    --setting=chaining.socksServerUri=socks5://127.0.0.1:22223 \
    --setting=chaining.routeId=beta \
    --setting=chaining.socksServerUri=socks5://127.0.0.1:33331 \
    --setting=chaining.socksServerUri=socks5://127.0.0.1:33332 \
    --setting=chaining.socksServerUri=socks5://127.0.0.1:33333 \
    --setting=lastRouteId=omega \
    --setting=routeSelectionStrategy=RANDOM \
    --setting=routeSelectionLogAction=LOG_AS_INFO
</code></pre></div>
<p>Server configuration file example:</p>

<div class="verbatim">
<pre><code class="language-xml">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot; standalone=&quot;yes&quot;?&gt;
&lt;configuration&gt;
    &lt;settings&gt;
        &lt;setting&gt;
            &lt;name&gt;chaining.socksServerUri&lt;/name&gt;
            &lt;value&gt;socks5://127.0.0.1:11111&lt;/value&gt;
        &lt;/setting&gt;
        &lt;setting&gt;
            &lt;name&gt;chaining.socksServerUri&lt;/name&gt;
            &lt;value&gt;socks5://127.0.0.1:11112&lt;/value&gt;
        &lt;/setting&gt;
        &lt;setting&gt;
            &lt;name&gt;chaining.socksServerUri&lt;/name&gt;
            &lt;value&gt;socks5://127.0.0.1:11113&lt;/value&gt;
        &lt;/setting&gt;
        &lt;setting&gt;
            &lt;name&gt;chaining.routeId&lt;/name&gt;
            &lt;value&gt;alpha&lt;/value&gt;
        &lt;/setting&gt;
        &lt;setting&gt;
            &lt;name&gt;chaining.socksServerUri&lt;/name&gt;
            &lt;value&gt;socks5://127.0.0.1:22221&lt;/value&gt;
        &lt;/setting&gt;
        &lt;setting&gt;
            &lt;name&gt;chaining.socksServerUri&lt;/name&gt;
            &lt;value&gt;socks5://127.0.0.1:22222&lt;/value&gt;
        &lt;/setting&gt;
        &lt;setting&gt;
            &lt;name&gt;chaining.socksServerUri&lt;/name&gt;
            &lt;value&gt;socks5://127.0.0.1:22223&lt;/value&gt;
        &lt;/setting&gt;
        &lt;setting&gt;
            &lt;name&gt;chaining.routeId&lt;/name&gt;
            &lt;value&gt;beta&lt;/value&gt;
        &lt;/setting&gt;
        &lt;setting&gt;
            &lt;name&gt;chaining.socksServerUri&lt;/name&gt;
            &lt;value&gt;socks5://127.0.0.1:33331&lt;/value&gt;
        &lt;/setting&gt;
        &lt;setting&gt;
            &lt;name&gt;chaining.socksServerUri&lt;/name&gt;
            &lt;value&gt;socks5://127.0.0.1:33332&lt;/value&gt;
        &lt;/setting&gt;
        &lt;setting&gt;
            &lt;name&gt;chaining.socksServerUri&lt;/name&gt;
            &lt;value&gt;socks5://127.0.0.1:33333&lt;/value&gt;
        &lt;/setting&gt;
        &lt;setting&gt;
            &lt;name&gt;lastRouteId&lt;/name&gt;
            &lt;value&gt;omega&lt;/value&gt;
        &lt;/setting&gt;
        &lt;setting&gt;
            &lt;name&gt;routeSelectionStrategy&lt;/name&gt;
            &lt;value&gt;RANDOM&lt;/value&gt;
        &lt;/setting&gt;
        &lt;setting&gt;
            &lt;name&gt;routeSelectionLogAction&lt;/name&gt;
            &lt;value&gt;LOG_AS_INFO&lt;/value&gt;
        &lt;/setting&gt;
    &lt;/settings&gt;
&lt;/configuration&gt;
</code></pre></div></section><section>
<h2>Using Rules to Manage Traffic</h2>
<p>A rule consists of the following:</p>
<ul>

<li>Rule conditions: fields that altogether evaluates as true if they match a
specific instance of traffic</li>
<li>Rule actions: fields that are applied if the aforementioned rule conditions
evaluate as true for matching a specific instance of traffic</li>
</ul>
<p>From the API and from the command line, a rule consists of a comma separated
list of both rule conditions and rule actions.</p>
<p>In the server configuration file, a rule is expressed as a <code>&lt;rule/&gt;</code> XML
element with a <code>&lt;ruleConditions/&gt;</code> XML element and a <code>&lt;ruleActions/&gt;</code> XML
element.</p>
<p>See <a href="#rule-conditions">Rule Conditions</a> and <a href="#rule-actions">Rule Actions</a> for
more information.</p>
<p>To specify a rule, you would need to have the setting <code>rule</code> specify the rule.</p>
<p>API example:</p>

<div class="verbatim">
<pre><code class="language-java">package com.example;

import com.github.jh3nd3rs0n.jargyle.server.Configuration;
import com.github.jh3nd3rs0n.jargyle.server.Setting;
import com.github.jh3nd3rs0n.jargyle.server.Settings;
import com.github.jh3nd3rs0n.jargyle.server.SocksServer;

import java.io.IOException;

public class ServerApp {
    public static void main(String[] args) throws IOException {
        new SocksServer(Configuration.newUnmodifiableInstance(Settings.of(
            /*
             * Allows all forms of traffic
             */
            Setting.newInstanceWithParsedValue(
                &quot;rule&quot;, &quot;firewallAction=ALLOW&quot;)
        ))).start();
    }
}
</code></pre></div>
<p>Command line example:</p>

<div class="verbatim">
<pre><code class="language-bash">jargyle start-server --setting=rule=firewallAction=ALLOW
</code></pre></div>
<p>Server configuration file example:</p>

<div class="verbatim">
<pre><code class="language-xml">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot; standalone=&quot;yes&quot;?&gt;
&lt;configuration&gt;
    &lt;settings&gt;
        &lt;setting&gt;
            &lt;name&gt;rule&lt;/name&gt;
            &lt;rule&gt;
                &lt;ruleConditions/&gt;
                &lt;ruleActions&gt;
                    &lt;ruleAction&gt;
                        &lt;name&gt;firewallAction&lt;/name&gt;
                        &lt;value&gt;ALLOW&lt;/value&gt;
                    &lt;/ruleAction&gt;
                &lt;/ruleActions&gt;
            &lt;/rule&gt;
        &lt;/setting&gt;
    &lt;/settings&gt;
&lt;/configuration&gt;
</code></pre></div>
<p>To specify multiple rules, you would need to have the setting <code>rule</code> specified
multiple times with each setting specifying another rule.</p>
<p>API example:</p>

<div class="verbatim">
<pre><code class="language-java">package com.example;

import com.github.jh3nd3rs0n.jargyle.server.Configuration;
import com.github.jh3nd3rs0n.jargyle.server.Setting;
import com.github.jh3nd3rs0n.jargyle.server.Settings;
import com.github.jh3nd3rs0n.jargyle.server.SocksServer;

import java.io.IOException;

public class ServerApp {
    public static void main(String[] args) throws IOException {
        new SocksServer(Configuration.newUnmodifiableInstance(Settings.of(
            /*
             * Allows the CONNECT request for any server on port 80 
             * or 443
             */
            Setting.newInstanceWithParsedValue(
                &quot;rule&quot;, 
                &quot;socks5.request.command=CONNECT,&quot;
                + &quot;socks5.request.desiredDestinationPort=80,&quot;
                + &quot;socks5.request.desiredDestinationPort=443,&quot;
                + &quot;firewallAction=ALLOW&quot;),
            /*
             * Denies the CONNECT request for any server on any 
             * other port
             */
            Setting.newInstanceWithParsedValue(
                &quot;rule&quot;, 
                &quot;socks5.request.command=CONNECT,firewallAction=DENY&quot;),
            /*
             * Allow anything else
             */
            Setting.newInstanceWithParsedValue(
                &quot;rule&quot;, &quot;firewallAction=ALLOW&quot;)
        ))).start();
    }
}
</code></pre></div>
<p>Command line example:</p>

<div class="verbatim">
<pre><code class="language-bash">jargyle start-server \
    --setting=rule=socks5.request.command=CONNECT,socks5.request.desiredDestinationPort=80,socks5.request.desiredDestinationPort=443,firewallAction=ALLOW \
    --setting=rule=socks5.request.command=CONNECT,firewallAction=DENY \
    --setting=rule=firewallAction=ALLOW
</code></pre></div>
<p>Server configuration file example:</p>

<div class="verbatim">
<pre><code class="language-xml">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot; standalone=&quot;yes&quot;?&gt;
&lt;configuration&gt;
    &lt;settings&gt;
        &lt;setting&gt;
            &lt;name&gt;rule&lt;/name&gt;
            &lt;rule&gt;
                &lt;ruleConditions&gt;
                    &lt;ruleCondition&gt;
                        &lt;name&gt;socks5.request.command&lt;/name&gt;
                        &lt;value&gt;CONNECT&lt;/value&gt;
                    &lt;/ruleCondition&gt;
                    &lt;ruleCondition&gt;
                        &lt;name&gt;socks5.request.desiredDestinationPort&lt;/name&gt;
                        &lt;value&gt;80&lt;/value&gt;
                    &lt;/ruleCondition&gt;
                    &lt;ruleCondition&gt;
                        &lt;name&gt;socks5.request.desiredDestinationPort&lt;/name&gt;
                        &lt;value&gt;443&lt;/value&gt;
                    &lt;/ruleCondition&gt;
                &lt;/ruleConditions&gt;
                &lt;ruleActions&gt;
                    &lt;ruleAction&gt;
                        &lt;name&gt;firewallAction&lt;/name&gt;
                        &lt;value&gt;ALLOW&lt;/value&gt;
                    &lt;/ruleAction&gt;
                &lt;/ruleActions&gt;
            &lt;/rule&gt;
        &lt;/setting&gt;
        &lt;setting&gt;
            &lt;name&gt;rule&lt;/name&gt;
            &lt;rule&gt;
                &lt;ruleConditions&gt;
                    &lt;ruleCondition&gt;
                        &lt;name&gt;socks5.request.command&lt;/name&gt;
                        &lt;value&gt;CONNECT&lt;/value&gt;
                    &lt;/ruleCondition&gt;
                &lt;/ruleConditions&gt;
                &lt;ruleActions&gt;
                    &lt;ruleAction&gt;
                        &lt;name&gt;firewallAction&lt;/name&gt;
                        &lt;value&gt;DENY&lt;/value&gt;
                    &lt;/ruleAction&gt;
                &lt;/ruleActions&gt;
            &lt;/rule&gt;
        &lt;/setting&gt;
        &lt;setting&gt;
            &lt;name&gt;rule&lt;/name&gt;
            &lt;rule&gt;
                &lt;ruleConditions/&gt;
                &lt;ruleActions&gt;
                    &lt;ruleAction&gt;
                        &lt;name&gt;firewallAction&lt;/name&gt;
                        &lt;value&gt;ALLOW&lt;/value&gt;
                    &lt;/ruleAction&gt;
                &lt;/ruleActions&gt;
            &lt;/rule&gt;
        &lt;/setting&gt;    
    &lt;/settings&gt;
&lt;/configuration&gt;
</code></pre></div>
<p>When a specific instance of traffic is matched by the first rule, that rule is
applied and the rest of the rules are ignored. Therefore, it is best to have
more specific rules specified first and have less specific rules specified
last.</p><section>
<h3>Rule Conditions</h3>
<p>From the API and from the command line, rule conditions consist of a comma
separated list of rule conditions. Each rule condition consists of the syntax
of <code>NAME=VALUE</code> where <code>NAME</code> is expressed as the name of the rule condition
and <code>VALUE</code> is expressed as the value assigned to the rule condition.</p>
<p>Partial API and command line example:</p>

<div class="verbatim">
<pre><code class="language-text">clientAddress=127.0.0.1,clientAddress=0:0:0:0:0:0:0:1
</code></pre></div>
<p>In the server configuration file, rule conditions are expressed in a
<code>&lt;ruleConditions/&gt;</code> XML element with zero to many <code>&lt;ruleCondition/&gt;</code> XML
elements. Each <code>&lt;ruleCondition/&gt;</code> XML element contains a <code>&lt;name/&gt;</code> XML
element for the name of the rule condition and the <code>&lt;value/&gt;</code> XML element of
the value assigned to the rule condition.</p>
<p>Partial server configuration file example:</p>

<div class="verbatim">
<pre><code class="language-xml">&lt;ruleConditions&gt;
    &lt;ruleCondition&gt;
        &lt;name&gt;clientAddress&lt;/name&gt;
        &lt;value&gt;127.0.0.1&lt;/value&gt;
    &lt;/ruleCondition&gt;
    &lt;ruleCondition&gt;
        &lt;name&gt;clientAddress&lt;/name&gt;
        &lt;value&gt;0:0:0:0:0:0:0:1&lt;/value&gt;
    &lt;/ruleCondition&gt;
&lt;/ruleConditions&gt;
</code></pre></div>
<p>All rule conditions together are evaluated as true if each group of one or
more rule conditions with the same name is evaluated as true. Within a group
of one or more rule conditions with the same name, all rule conditions
together are evaluated as true if at least one of the rule conditions within
that group is evaluated as true. Zero rule conditions is evaluated as true.</p>
<p>Partial API examples:</p>

<div class="verbatim">
<pre><code class="language-text">/*
 * Evaluates as true if the client address is the IPv4 loopback 
 * address or the IPv6 loopback address
 */
&quot;clientAddress=127.0.0.1,clientAddress=0:0:0:0:0:0:0:1&quot;
</code></pre></div>

<div class="verbatim">
<pre><code class="language-text">/*
 * Evaluates as true if username password authentication was used 
 * and the user is either 'guest' or 'specialuser'
 */
&quot;socks5.method=USERNAME_PASSWORD,socks5.user=guest,socks5.user=specialuser&quot;
</code></pre></div>

<div class="verbatim">
<pre><code class="language-text">/*
 * Evaluates as true since there are no rule conditions given
 */
&quot;&quot;
</code></pre></div>
<p>A complete listing of rule conditions can be found
<a href="../reference/rule-conditions.html">here</a>.</p></section><section>
<h3>Rule Actions</h3>
<p>From the API and from the command line, rule actions consist of a comma
separated list of rule actions. Each rule action consists of the syntax of
<code>NAME=VALUE</code> where <code>NAME</code> is expressed as the name of the rule action and
<code>VALUE</code> is expressed as the value assigned to the rule action.</p>
<p>Partial API and command line example:</p>

<div class="verbatim">
<pre><code class="language-text">firewallAction=ALLOW,firewallActionLogAction=LOG_AS_INFO
</code></pre></div>
<p>In the server configuration file, rule action are expressed in a <code>&lt;ruleActions/&gt;</code>
XML element with zero to many <code>&lt;ruleAction/&gt;</code> XML elements. Each
<code>&lt;ruleAction/&gt;</code> XML element contains a <code>&lt;name/&gt;</code> XML element for the name of
the rule action and the <code>&lt;value/&gt;</code> XML element of the value assigned to the
rule action.</p>
<p>Partial server configuration file example:</p>

<div class="verbatim">
<pre><code class="language-xml">&lt;ruleActions&gt;
    &lt;ruleAction&gt;
        &lt;name&gt;firewallAction&lt;/name&gt;
        &lt;value&gt;ALLOW&lt;/value&gt;
    &lt;/ruleAction&gt;
    &lt;ruleAction&gt;
        &lt;name&gt;firewallActionLogAction&lt;/name&gt;
        &lt;value&gt;LOG_AS_INFO&lt;/value&gt;
    &lt;/ruleAction&gt;
&lt;/ruleActions&gt;
</code></pre></div>
<p>Unless otherwise stated, if a rule action of the same name appears more than
once in the comma separated list or in the <code>&lt;ruleActions/&gt;</code> XML element, then
only the last rule action of the same name is recognized.</p>
<p>A complete listing of rule actions can be found
<a href="../reference/rule-actions.html">here</a>.</p></section><section>
<h3>Allowing or Denying Traffic</h3>
<p>To allow or deny a specific instance of traffic, you will need the following
rule action:</p>
<ul>

<li><code>firewallAction</code></li>
</ul>
<p>The value given to the rule action must be either of the following values:</p>
<ul>

<li><code>ALLOW</code></li>
<li><code>DENY</code></li>
</ul>
<p>This rule action can be used with the following rule conditions:</p>
<ul>

<li><code>clientAddress</code></li>
<li><code>socks5.method</code></li>
<li><code>socks5.reply.serverBoundAddress</code></li>
<li><code>socks5.reply.serverBoundPort</code></li>
<li><code>socks5.request.command</code></li>
<li><code>socks5.request.desiredDestinationAddress</code></li>
<li><code>socks5.request.desiredDestinationPort</code></li>
<li><code>socks5.secondReply.serverBoundAddress</code></li>
<li><code>socks5.secondReply.serverBoundPort</code></li>
<li><code>socks5.udp.inbound.desiredDestinationAddress</code></li>
<li><code>socks5.udp.inbound.desiredDestinationPort</code></li>
<li><code>socks5.udp.inbound.sourceAddress</code></li>
<li><code>socks5.udp.inbound.sourcePort</code></li>
<li><code>socks5.udp.outbound.desiredDestinationAddress</code></li>
<li><code>socks5.udp.outbound.desiredDestinationPort</code></li>
<li><code>socks5.udp.outbound.sourceAddress</code></li>
<li><code>socks5.udp.outbound.sourcePort</code></li>
<li><code>socks5.user</code></li>
<li><code>socksServerAddress</code></li>
</ul>
<p><strong>Note</strong>: for any other rule actions to be applied, the rule action
<code>firewallAction</code> with the value of <code>ALLOW</code> must be present.</p>
<p>You can also specify the logging action to take if the rule action
<code>firewallAction</code> is applied by adding the following rule action:</p>
<ul>

<li><code>firewallActionLogAction</code></li>
</ul>
<p>The rule action <code>firewallActionLogAction</code> is optional.</p>
<p>API example:</p>

<div class="verbatim">
<pre><code class="language-java">package com.example;

import com.github.jh3nd3rs0n.jargyle.server.Configuration;
import com.github.jh3nd3rs0n.jargyle.server.Setting;
import com.github.jh3nd3rs0n.jargyle.server.Settings;
import com.github.jh3nd3rs0n.jargyle.server.SocksServer;

import java.io.IOException;

public class ServerApp {
    public static void main(String[] args) throws IOException {
        new SocksServer(Configuration.newUnmodifiableInstance(Settings.of(
            /*
             * Deny any BIND or UDP ASSOCIATE requests and log as a warning 
             * message their denials
             */
            Setting.newInstanceWithParsedValue(
                &quot;rule&quot;,
                 &quot;socks5.request.command=BIND,&quot;
                 + &quot;socks5.request.command=UDP_ASSOCIATE,&quot;
                 + &quot;firewallAction=DENY,&quot;
                 + &quot;firewallActionLogAction=LOG_AS_WARNING&quot;),
            /*
             * Allow anything else
             */
            Setting.newInstanceWithParsedValue(
                &quot;rule&quot;, &quot;firewallAction=ALLOW&quot;)
        ))).start();
    }
}
</code></pre></div>
<p>Command line example:</p>

<div class="verbatim">
<pre><code class="language-bash">jargyle start-server \
    --setting=rule=socks5.request.command=BIND,socks5.request.command=UDP_ASSOCIATE,firewallAction=DENY,firewallActionLogAction=LOG_AS_WARNING \
    --setting=rule=firewallAction=ALLOW
</code></pre></div>
<p>Server configuration file example:</p>

<div class="verbatim">
<pre><code class="language-xml">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot; standalone=&quot;yes&quot;?&gt;
&lt;configuration&gt;
    &lt;settings&gt;
        &lt;setting&gt;
            &lt;name&gt;rule&lt;/name&gt;
            &lt;rule&gt;
                &lt;ruleConditions&gt;
                    &lt;ruleCondition&gt;
                        &lt;name&gt;socks5.request.command&lt;/name&gt;
                        &lt;value&gt;BIND&lt;/value&gt;
                    &lt;/ruleCondition&gt;
                    &lt;ruleCondition&gt;
                        &lt;name&gt;socks5.request.command&lt;/name&gt;
                        &lt;value&gt;UDP_ASSOCIATE&lt;/value&gt;
                    &lt;/ruleCondition&gt;
                &lt;/ruleConditions&gt;
                &lt;ruleActions&gt;
                    &lt;ruleAction&gt;
                        &lt;name&gt;firewallAction&lt;/name&gt;
                        &lt;value&gt;DENY&lt;/value&gt;
                    &lt;/ruleAction&gt;
                    &lt;ruleAction&gt;
                        &lt;name&gt;firewallActionLogAction&lt;/name&gt;
                        &lt;value&gt;LOG_AS_WARNING&lt;/value&gt;
                    &lt;/ruleAction&gt;                
                &lt;/ruleActions&gt;
            &lt;/rule&gt;
        &lt;/setting&gt;
        &lt;setting&gt;
            &lt;name&gt;rule&lt;/name&gt;
            &lt;rule&gt;
                &lt;ruleConditions/&gt;
                &lt;ruleActions&gt;
                    &lt;ruleAction&gt;
                        &lt;name&gt;firewallAction&lt;/name&gt;
                        &lt;value&gt;ALLOW&lt;/value&gt;
                    &lt;/ruleAction&gt;
                &lt;/ruleActions&gt;
            &lt;/rule&gt;
        &lt;/setting&gt;    
    &lt;/settings&gt;
&lt;/configuration&gt;
</code></pre></div></section><section>
<h3>Allowing a Limited Number of Simultaneous Instances of Traffic</h3>
<p>To allow a limited number of simultaneous specific instances of traffic, you
will need the following rule action:</p>
<ul>

<li><code>firewallActionAllowLimit</code></li>
</ul>
<p>The value given to the rule action must be an integer between 0 (inclusive) and
2147483647 (inclusive)</p>
<p>This rule action can be used with the following rule conditions:</p>
<ul>

<li><code>clientAddress</code></li>
<li><code>socks5.method</code></li>
<li><code>socks5.reply.serverBoundAddress</code></li>
<li><code>socks5.reply.serverBoundPort</code></li>
<li><code>socks5.request.command</code></li>
<li><code>socks5.request.desiredDestinationAddress</code></li>
<li><code>socks5.request.desiredDestinationPort</code></li>
<li><code>socks5.secondReply.serverBoundAddress</code></li>
<li><code>socks5.secondReply.serverBoundPort</code></li>
<li><code>socks5.user</code></li>
<li><code>socksServerAddress</code></li>
</ul>
<p>You can also specify the logging action to take if the limit on the number of
simultaneous specific instances of traffic has been reached by adding the
following rule action:</p>
<ul>

<li><code>firewallActionAllowLimitReachedLogAction</code></li>
</ul>
<p>The rule action <code>firewallActionAllowLimitReachedLogAction</code> is optional.</p>
<p>API example:</p>

<div class="verbatim">
<pre><code class="language-java">package com.example;

import com.github.jh3nd3rs0n.jargyle.server.Configuration;
import com.github.jh3nd3rs0n.jargyle.server.Setting;
import com.github.jh3nd3rs0n.jargyle.server.Settings;
import com.github.jh3nd3rs0n.jargyle.server.SocksServer;

import java.io.IOException;

public class ServerApp {
    public static void main(String[] args) throws IOException {
        new SocksServer(Configuration.newUnmodifiableInstance(Settings.of(
            /*
             * Allow the user 'guest' from username password 
             * authentication 50 simultaneous connections and log 
             * as an informational message when the limit has been 
             * reached
             */
            Setting.newInstanceWithParsedValue(
                &quot;rule&quot;, 
                &quot;socks5.method=USERNAME_PASSWORD,&quot;
                + &quot;socks5.user=guest,&quot;
                + &quot;firewallAction=ALLOW,&quot;
                + &quot;firewallActionAllowLimit=50,&quot;
                + &quot;firewallActionAllowLimitReachedLogAction=LOG_AS_INFO&quot;),
            /*
             * Allow anything else
             */
            Setting.newInstanceWithParsedValue(
                &quot;rule&quot;, &quot;firewallAction=ALLOW&quot;)
        ))).start();
    }
}
</code></pre></div>
<p>Command line example:</p>

<div class="verbatim">
<pre><code class="language-bash">jargyle start-server \
    --setting=rule=socks5.method=USERNAME_PASSWORD,socks5.user=guest,firewallAction=ALLOW,firewallActionAllowLimit=50,firewallActionAllowLimitReachedLogAction=LOG_AS_INFO \
    --setting=rule=firewallAction=ALLOW
</code></pre></div>
<p>Server configuration file example:</p>

<div class="verbatim">
<pre><code class="language-xml">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot; standalone=&quot;yes&quot;?&gt;
&lt;configuration&gt;
    &lt;settings&gt;
        &lt;setting&gt;
            &lt;name&gt;rule&lt;/name&gt;
            &lt;rule&gt;
                &lt;ruleConditions&gt;
                    &lt;ruleCondition&gt;
                        &lt;name&gt;socks5.method&lt;/name&gt;
                        &lt;value&gt;USERNAME_PASSWORD&lt;/value&gt;
                    &lt;/ruleCondition&gt;
                    &lt;ruleCondition&gt;
                        &lt;name&gt;socks5.user&lt;/name&gt;
                        &lt;value&gt;guest&lt;/value&gt;
                    &lt;/ruleCondition&gt;
                &lt;/ruleConditions&gt;
                &lt;ruleActions&gt;
                    &lt;ruleAction&gt;
                        &lt;name&gt;firewallAction&lt;/name&gt;
                        &lt;value&gt;ALLOW&lt;/value&gt;
                    &lt;/ruleAction&gt;
                    &lt;ruleAction&gt;
                        &lt;name&gt;firewallActionAllowLimit&lt;/name&gt;
                        &lt;value&gt;50&lt;/value&gt;
                    &lt;/ruleAction&gt;                
                    &lt;ruleAction&gt;
                        &lt;name&gt;firewallActionAllowLimitReachedLogAction&lt;/name&gt;
                        &lt;value&gt;LOG_AS_INFO&lt;/value&gt;
                    &lt;/ruleAction&gt;
                &lt;/ruleActions&gt;
            &lt;/rule&gt;
        &lt;/setting&gt;
        &lt;setting&gt;
            &lt;name&gt;rule&lt;/name&gt;
            &lt;rule&gt;
                &lt;ruleConditions/&gt;
                &lt;ruleActions&gt;
                    &lt;ruleAction&gt;
                        &lt;name&gt;firewallAction&lt;/name&gt;
                        &lt;value&gt;ALLOW&lt;/value&gt;
                    &lt;/ruleAction&gt;
                &lt;/ruleActions&gt;
            &lt;/rule&gt;
        &lt;/setting&gt;
    &lt;/settings&gt;
&lt;/configuration&gt;
</code></pre></div>
<p><a id="routing-traffic-through-a-selection-of-specified-chains-of-socks-servers"></a></p></section><section>
<h3>Routing Traffic Through a Selection of Specified Chains of SOCKS Servers</h3>
<p>To route traffic through a selection of specified chains of SOCKS servers, you
can use the following rule actions:</p>
<ul>

<li><code>routeSelectionStrategy</code>: Specifies the selection strategy for the next
route (This rule action is optional. If this rule action is not specified, the
setting <code>routeSelectionStrategy</code> is used.)</li>
<li><code>selectableRouteId</code>: Specifies the ID for a selectable
<a href="#chaining-to-specified-chains-of-other-socks-servers">route</a> (This rule
action is optional. This rule action can be specified multiple times with each
rule action specifying another ID for a selectable route. If this rule action
is not specified, all the routes defined by the settings <code>chaining.routeId</code>
and <code>lastRouteId</code> are selectable.)</li>
</ul>
<p>These rule actions can be used with the following rule conditions:</p>
<ul>

<li><code>clientAddress</code></li>
<li><code>socks5.method</code></li>
<li><code>socks5.request.command</code></li>
<li><code>socks5.request.desiredDestinationAddress</code></li>
<li><code>socks5.request.desiredDestinationPort</code></li>
<li><code>socks5.user</code></li>
<li><code>socksServerAddress</code></li>
</ul>
<p>You can also specify the logging action to take if a route is selected by adding
the following rule action:</p>
<ul>

<li><code>routeSelectionLogAction</code></li>
</ul>
<p>The rule action <code>routeSelectionLogAction</code> is optional. If the rule action is
not specified, the setting <code>routeSelectionLogAction</code> is used.</p>
<p>API example:</p>

<div class="verbatim">
<pre><code class="language-java">package com.example;

import com.github.jh3nd3rs0n.jargyle.server.Configuration;
import com.github.jh3nd3rs0n.jargyle.server.Setting;
import com.github.jh3nd3rs0n.jargyle.server.Settings;
import com.github.jh3nd3rs0n.jargyle.server.SocksServer;

import java.io.IOException;

public class ServerApp {
    public static void main(String[] args) throws IOException {
        new SocksServer(Configuration.newUnmodifiableInstance(Settings.of(
            Setting.newInstanceWithParsedValue(
                &quot;chaining.socksServerUri&quot;, 
                &quot;socks5://127.0.0.1:11111&quot;),
            Setting.newInstanceWithParsedValue(
                &quot;chaining.socksServerUri&quot;, 
                &quot;socks5://127.0.0.1:11112&quot;),
            Setting.newInstanceWithParsedValue(
                &quot;chaining.socksServerUri&quot;, 
                &quot;socks5://127.0.0.1:11113&quot;),
            Setting.newInstanceWithParsedValue(
                &quot;chaining.routeId&quot;, &quot;alpha&quot;),
            Setting.newInstanceWithParsedValue(
                &quot;chaining.socksServerUri&quot;, 
                &quot;socks5://127.0.0.1:22221&quot;),
            Setting.newInstanceWithParsedValue(
                &quot;chaining.socksServerUri&quot;, 
                &quot;socks5://127.0.0.1:22222&quot;),
            Setting.newInstanceWithParsedValue(
                &quot;chaining.socksServerUri&quot;, 
                &quot;socks5://127.0.0.1:22223&quot;),
            Setting.newInstanceWithParsedValue(
                &quot;chaining.routeId&quot;, &quot;beta&quot;),
            Setting.newInstanceWithParsedValue(
                &quot;chaining.socksServerUri&quot;, 
                &quot;socks5://127.0.0.1:33331&quot;),
            Setting.newInstanceWithParsedValue(
                &quot;chaining.socksServerUri&quot;, 
                &quot;socks5://127.0.0.1:33332&quot;),
            Setting.newInstanceWithParsedValue(
                &quot;chaining.socksServerUri&quot;, 
                &quot;socks5://127.0.0.1:33333&quot;),
            Setting.newInstanceWithParsedValue(
                &quot;lastRouteId&quot;, &quot;omega&quot;),
            /*
             * Randomly select either route 'alpha' or 'beta' when 
             * allowing the CONNECT request and log as an 
             * informational message the route that has been 
             * selected
             */
            Setting.newInstanceWithParsedValue(
                &quot;rule&quot;,
                &quot;socks5.request.command=CONNECT,&quot;
                + &quot;firewallAction=ALLOW,&quot;
                + &quot;routeSelectionStrategy=RANDOM,&quot;
                + &quot;selectableRouteId=alpha,&quot;
                + &quot;selectableRouteId=beta,&quot;
                + &quot;routeSelectionLogAction=LOG_AS_INFO&quot;),
            /*
             * Allow anything else to go through route 'omega'
             */
            Setting.newInstanceWithParsedValue(
                &quot;rule&quot;,
                &quot;firewallAction=ALLOW,&quot;
                + &quot;routeSelectionStrategy=CYCLICAL,&quot;
                + &quot;selectableRouteId=omega&quot;)
        ))).start();
    }
}
</code></pre></div>
<p>Command line example:</p>

<div class="verbatim">
<pre><code class="language-bash">jargyle start-server \
    --setting=chaining.socksServerUri=socks5://127.0.0.1:11111 \
    --setting=chaining.socksServerUri=socks5://127.0.0.1:11112 \
    --setting=chaining.socksServerUri=socks5://127.0.0.1:11113 \
    --setting=chaining.routeId=alpha \
    --setting=chaining.socksServerUri=socks5://127.0.0.1:22221 \
    --setting=chaining.socksServerUri=socks5://127.0.0.1:22222 \
    --setting=chaining.socksServerUri=socks5://127.0.0.1:22223 \
    --setting=chaining.routeId=beta \
    --setting=chaining.socksServerUri=socks5://127.0.0.1:33331 \
    --setting=chaining.socksServerUri=socks5://127.0.0.1:33332 \
    --setting=chaining.socksServerUri=socks5://127.0.0.1:33333 \
    --setting=lastRouteId=omega \
    --setting=rule=socks5.request.command=CONNECT,firewallAction=ALLOW,routeSelectionStrategy=RANDOM,selectableRouteId=alpha,selectableRouteId=beta,routeSelectionLogAction=LOG_AS_INFO \
    --setting=rule=firewallAction=ALLOW,routeSelectionStrategy=CYCLICAL,selectableRouteId=omega
</code></pre></div>
<p>Server configuration file example:</p>

<div class="verbatim">
<pre><code class="language-xml">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot; standalone=&quot;yes&quot;?&gt;
&lt;configuration&gt;
    &lt;settings&gt;
        &lt;setting&gt;
            &lt;name&gt;chaining.socksServerUri&lt;/name&gt;
            &lt;value&gt;socks5://127.0.0.1:11111&lt;/value&gt;
        &lt;/setting&gt;
        &lt;setting&gt;
            &lt;name&gt;chaining.socksServerUri&lt;/name&gt;
            &lt;value&gt;socks5://127.0.0.1:11112&lt;/value&gt;
        &lt;/setting&gt;
        &lt;setting&gt;
            &lt;name&gt;chaining.socksServerUri&lt;/name&gt;
            &lt;value&gt;socks5://127.0.0.1:11113&lt;/value&gt;
        &lt;/setting&gt;
        &lt;setting&gt;
            &lt;name&gt;chaining.routeId&lt;/name&gt;
            &lt;value&gt;alpha&lt;/value&gt;
        &lt;/setting&gt;
        &lt;setting&gt;
            &lt;name&gt;chaining.socksServerUri&lt;/name&gt;
            &lt;value&gt;socks5://127.0.0.1:22221&lt;/value&gt;
        &lt;/setting&gt;
        &lt;setting&gt;
            &lt;name&gt;chaining.socksServerUri&lt;/name&gt;
            &lt;value&gt;socks5://127.0.0.1:22222&lt;/value&gt;
        &lt;/setting&gt;
        &lt;setting&gt;
            &lt;name&gt;chaining.socksServerUri&lt;/name&gt;
            &lt;value&gt;socks5://127.0.0.1:22223&lt;/value&gt;
        &lt;/setting&gt;
        &lt;setting&gt;
            &lt;name&gt;chaining.routeId&lt;/name&gt;
            &lt;value&gt;beta&lt;/value&gt;
        &lt;/setting&gt;
        &lt;setting&gt;
            &lt;name&gt;chaining.socksServerUri&lt;/name&gt;
            &lt;value&gt;socks5://127.0.0.1:33331&lt;/value&gt;
        &lt;/setting&gt;
        &lt;setting&gt;
            &lt;name&gt;chaining.socksServerUri&lt;/name&gt;
            &lt;value&gt;socks5://127.0.0.1:33332&lt;/value&gt;
        &lt;/setting&gt;
        &lt;setting&gt;
            &lt;name&gt;chaining.socksServerUri&lt;/name&gt;
            &lt;value&gt;socks5://127.0.0.1:33333&lt;/value&gt;
        &lt;/setting&gt;
        &lt;setting&gt;
            &lt;name&gt;lastRouteId&lt;/name&gt;
            &lt;value&gt;omega&lt;/value&gt;
        &lt;/setting&gt;
        &lt;setting&gt;
            &lt;name&gt;rule&lt;/name&gt;
            &lt;rule&gt;
                &lt;ruleConditions&gt;
                    &lt;ruleCondition&gt;
                        &lt;name&gt;socks5.request.command&lt;/name&gt;
                        &lt;value&gt;CONNECT&lt;/value&gt;
                    &lt;/ruleCondition&gt;
                &lt;/ruleConditions&gt;
                &lt;ruleActions&gt;
                    &lt;ruleAction&gt;
                        &lt;name&gt;firewallAction&lt;/name&gt;
                        &lt;value&gt;ALLOW&lt;/value&gt;
                    &lt;/ruleAction&gt;
                    &lt;ruleAction&gt;
                        &lt;name&gt;routeSelectionStrategy&lt;/name&gt;
                        &lt;value&gt;RANDOM&lt;/value&gt;
                    &lt;/ruleAction&gt;
                    &lt;ruleAction&gt;
                        &lt;name&gt;selectableRouteId&lt;/name&gt;
                        &lt;value&gt;alpha&lt;/value&gt;
                    &lt;/ruleAction&gt;
                    &lt;ruleAction&gt;
                        &lt;name&gt;selectableRouteId&lt;/name&gt;
                        &lt;value&gt;beta&lt;/value&gt;
                    &lt;/ruleAction&gt;
                    &lt;ruleAction&gt;
                        &lt;name&gt;routeSelectionLogAction&lt;/name&gt;
                        &lt;value&gt;LOG_AS_INFO&lt;/value&gt;
                    &lt;/ruleAction&gt;
                &lt;/ruleActions&gt;
            &lt;/rule&gt;
        &lt;/setting&gt;
        &lt;setting&gt;
            &lt;name&gt;rule&lt;/name&gt;
            &lt;rule&gt;
                &lt;ruleConditions/&gt;
                &lt;ruleActions&gt;
                    &lt;ruleAction&gt;
                        &lt;name&gt;firewallAction&lt;/name&gt;
                        &lt;value&gt;ALLOW&lt;/value&gt;
                    &lt;/ruleAction&gt;
                    &lt;ruleAction&gt;
                        &lt;name&gt;routeSelectionStrategy&lt;/name&gt;
                        &lt;value&gt;CYCLICAL&lt;/value&gt;
                    &lt;/ruleAction&gt;
                    &lt;ruleAction&gt;
                        &lt;name&gt;selectableRouteId&lt;/name&gt;
                        &lt;value&gt;omega&lt;/value&gt;
                    &lt;/ruleAction&gt;
                &lt;/ruleActions&gt;
            &lt;/rule&gt;
        &lt;/setting&gt;    
    &lt;/settings&gt;
&lt;/configuration&gt;
</code></pre></div></section><section>
<h3>Redirecting the Desired Destination</h3>
<p>To redirect the desired destination, you will need either or both of the
following rule actions:</p>
<ul>

<li><code>socks5.request.desiredDestinationAddressRedirect</code>: Specifies the desired
destination address redirect</li>
<li><code>socks5.request.desiredDestinationPortRedirect</code>: Specifies the desired
destination port redirect</li>
</ul>
<p>These rule actions can be used with the following rule conditions:</p>
<ul>

<li><code>clientAddress</code></li>
<li><code>socks5.method</code></li>
<li><code>socks5.request.command</code></li>
<li><code>socks5.request.desiredDestinationAddress</code></li>
<li><code>socks5.request.desiredDestinationPort</code></li>
<li><code>socks5.user</code></li>
<li><code>socksServerAddress</code></li>
</ul>
<p>You can also specify the logging action to take if the desired destination is
redirected by adding the following rule action:</p>
<ul>

<li><code>socks5.request.desiredDestinationRedirectLogAction</code></li>
</ul>
<p>The rule action <code>socks5.request.desiredDestinationRedirectLogAction</code> is optional.</p>
<p>API example:</p>

<div class="verbatim">
<pre><code class="language-java">package com.example;

import com.github.jh3nd3rs0n.jargyle.server.Configuration;
import com.github.jh3nd3rs0n.jargyle.server.Setting;
import com.github.jh3nd3rs0n.jargyle.server.Settings;
import com.github.jh3nd3rs0n.jargyle.server.SocksServer;

import java.io.IOException;

public class ServerApp {
    public static void main(String[] args) throws IOException {
        new SocksServer(Configuration.newUnmodifiableInstance(Settings.of(
            /*
             * Redirect desired destination 'discontinuedserver.com' 
             * to 'newserver.com' and log as an informational 
             * message the redirection
             */
            Setting.newInstanceWithParsedValue(
                &quot;rule&quot;, 
                &quot;socks5.request.desiredDestinationAddress=discontinuedserver.com,&quot;
                + &quot;firewallAction=ALLOW,&quot;
                + &quot;socks5.request.desiredDestinationAddressRedirect=newserver.com,&quot;
                + &quot;socks5.request.desiredDestinationRedirectLogAction=LOG_AS_INFO&quot;),
            /*
             * Allow anything else
             */
            Setting.newInstanceWithParsedValue(
                &quot;rule&quot;, &quot;firewallAction=ALLOW&quot;)
        ))).start();
    }
}
</code></pre></div>
<p>Command line example:</p>

<div class="verbatim">
<pre><code class="language-bash">jargyle start-server \
    --setting=rule=socks5.request.desiredDestinationAddress=discontinuedserver.com,firewallAction=ALLOW,socks5.request.desiredDestinationAddressRedirect=newserver.com,socks5.request.desiredDestinationRedirectLogAction=LOG_AS_INFO \
    --setting=rule=firewallAction=ALLOW
</code></pre></div>
<p>Server configuration file example:</p>

<div class="verbatim">
<pre><code class="language-xml">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot; standalone=&quot;yes&quot;?&gt;
&lt;configuration&gt;
    &lt;settings&gt;
        &lt;setting&gt;
            &lt;name&gt;rule&lt;/name&gt;
            &lt;rule&gt;
                &lt;ruleConditions&gt;
                    &lt;ruleCondition&gt;
                        &lt;name&gt;socks5.request.desiredDestinationAddress&lt;/name&gt;
                        &lt;value&gt;discontinuedserver.com&lt;/value&gt;
                    &lt;/ruleCondition&gt;
                &lt;/ruleConditions&gt;
                &lt;ruleActions&gt;
                    &lt;ruleAction&gt;
                        &lt;name&gt;firewallAction&lt;/name&gt;
                        &lt;value&gt;ALLOW&lt;/value&gt;
                    &lt;/ruleAction&gt;
                    &lt;ruleAction&gt;
                        &lt;name&gt;socks5.request.desiredDestinationAddressRedirect&lt;/name&gt;
                        &lt;value&gt;newserver.com&lt;/value&gt;
                    &lt;/ruleAction&gt;
                    &lt;ruleAction&gt;
                        &lt;name&gt;socks5.request.desiredDestinationRedirectLogAction&lt;/name&gt;
                        &lt;value&gt;LOG_AS_INFO&lt;/value&gt;
                    &lt;/ruleAction&gt;
                &lt;/ruleActions&gt;
            &lt;/rule&gt;
        &lt;/setting&gt;
        &lt;setting&gt;
            &lt;name&gt;rule&lt;/name&gt;
            &lt;rule&gt;
                &lt;ruleConditions/&gt;
                &lt;ruleActions&gt;
                    &lt;ruleAction&gt;
                        &lt;name&gt;firewallAction&lt;/name&gt;
                        &lt;value&gt;ALLOW&lt;/value&gt;
                    &lt;/ruleAction&gt;
                &lt;/ruleActions&gt;
            &lt;/rule&gt;
        &lt;/setting&gt;    
    &lt;/settings&gt;
&lt;/configuration&gt;
</code></pre></div></section><section>
<h3>Configuring Sockets</h3>
<p>To configure the sockets, you will need any of the following rule actions:</p>
<ul>

<li><code>bindHost</code>: Specifies the binding host name or address for all sockets</li>
<li><code>bindTcpPortRange</code>: Specifies a binding port range for all TCP sockets
(This rule action can be specified multiple times with each rule action
specifying another port range)</li>
<li><code>bindUdpPortRange</code>: Specifies a binding port range for all UDP sockets
(This rule action can be specified multiple times with each rule action
specifying another port range)</li>
<li><code>clientSocketSetting</code>: Specifies a socket setting for the client socket
(This rule action can be specified multiple times with each rule action
specifying another socket setting)</li>
<li><code>externalFacingBindHost</code>: Specifies the binding host name or address
for all external-facing sockets</li>
<li><code>externalFacingBindTcpPortRange</code>: Specifies a binding
port range for all external-facing TCP
sockets (This rule action can be specified multiple times with each rule action
specifying another port range)</li>
<li><code>externalFacingBindUdpPortRange</code>: Specifies a binding
port range for all external-facing UDP
sockets (This rule action can be specified multiple times with each rule action
specifying another port range)</li>
<li><code>externalFacingSocketSetting</code>: Specifies a socket setting for all
external-facing sockets (This rule action can be specified multiple times with
each rule action specifying another socket setting)</li>
<li><code>internalFacingBindHost</code>: Specifies the binding host name or address for
all internal-facing sockets</li>
<li><code>internalFacingBindUdpPortRange</code>: Specifies a binding
port range for all internal-facing UDP
sockets (This rule action can be specified multiple times with each rule action
specifying another port range)</li>
<li><code>internalFacingSocketSetting</code>: Specifies a socket setting for all
internal-facing sockets (This rule action can be specified multiple times with
each rule action specifying another socket setting)</li>
<li><code>socketSetting</code>: Specifies a socket setting for all sockets (This rule
action can be specified multiple times with each rule action specifying another
socket setting)</li>
<li><code>socks5.onBindRequest.inboundSocketSetting</code>: Specifies a socket setting for
the inbound socket (This rule action can be specified multiple times with each
rule action specifying another socket setting)</li>
<li><code>socks5.onBindRequest.listenBindHost</code>: Specifies the binding host name or
address for the listen socket if the provided host address is all zeros</li>
<li><code>socks5.onBindRequest.listenBindPortRange</code>: Specifies a binding
port range for the listen socket if the provided port is zero (This rule
action can be specified multiple times with each rule action specifying another
port range)</li>
<li><code>socks5.onBindRequest.listenSocketSetting</code>: Specifies a socket setting for
the listen socket (This rule action can be specified multiple times with each
rule action specifying another socket setting)</li>
<li><code>socks5.onConnectRequest.prepareTargetFacingSocket</code>: Specifies the boolean
value to indicate if the target-facing socket is to be prepared before
connecting (involves applying the specified socket settings, resolving the
target host name, and setting the specified timeout on waiting to connect)</li>
<li><code>socks5.onConnectRequest.targetFacingBindHost</code>: Specifies the binding host
name or address for the target-facing socket</li>
<li><code>socks5.onConnectRequest.targetFacingBindPortRange</code>: Specifies a binding
port range for the target-facing socket (This rule action can be specified
multiple times with each rule action specifying another port range)</li>
<li><code>socks5.onConnectRequest.targetFacingConnectTimeout</code>: Specifies the timeout
in milliseconds on waiting for the target-facing socket to connect (Value must
be an integer between 1 (inclusive) and 2147483647 (inclusive))</li>
<li><code>socks5.onConnectRequest.targetFacingSocketSetting</code>: Specifies a socket
setting for the target-facing socket (This rule action can be specified multiple
times with each rule action specifying another socket setting)</li>
<li><code>socks5.onRequest.bindHost</code>: Specifies the binding host name or address
for all sockets</li>
<li><code>socks5.onRequest.bindTcpPortRange</code>: Specifies a binding
port range for all TCP sockets (This rule action can be specified multiple
times with each rule action specifying another port range)</li>
<li><code>socks5.onRequest.bindUdpPortRange</code>: Specifies a binding
port range for all UDP sockets (This rule action can be specified multiple
times with each rule action specifying another port range)</li>
<li><code>socks5.onRequest.externalFacingBindHost</code>: Specifies the binding host
name or address for all external-facing sockets</li>
<li><code>socks5.onRequest.externalFacingBindTcpPortRange</code>: Specifies a
binding port range for all external-facing TCP sockets (This rule action can be
specified multiple times with each rule action specifying another port range)</li>
<li><code>socks5.onRequest.externalFacingBindUdpPortRange</code>: Specifies a
binding port range for all external-facing UDP sockets (This rule action can be
specified multiple times with each rule action specifying another port range)</li>
<li><code>socks5.onRequest.externalFacingSocketSetting</code>: Specifies a socket
setting for all external-facing sockets (This rule action can be specified
multiple times with each rule action specifying another socket setting)</li>
<li><code>socks5.onRequest.internalFacingBindHost</code>: Specifies the binding
host name or address for all internal-facing sockets</li>
<li><code>socks5.onRequest.internalFacingBindUdpPortRange</code>: Specifies a
binding port range for all internal-facing UDP sockets (This rule action can be
specified multiple times with each rule action specifying another port range)</li>
<li><code>socks5.onRequest.internalFacingSocketSetting</code>: Specifies a socket
setting for all internal-facing sockets (This rule action can be specified
multiple times with each rule action specifying another socket setting)</li>
<li><code>socks5.onRequest.socketSetting</code>: Specifies a socket setting for all
sockets (This rule action can be specified multiple times with each rule action
specifying another socket setting)</li>
<li><code>socks5.onUdpAssociateRequest.clientFacingBindHost</code>: Specifies the binding
host name or address for the client-facing UDP socket</li>
<li><code>socks5.onUdpAssociateRequest.clientFacingBindPortRange</code>: Specifies a
binding port range for the client-facing UDP socket (This rule action can be
specified multiple times with each rule action specifying another port range)</li>
<li><code>socks5.onUdpAssociateRequest.clientFacingSocketSetting</code>: Specifies a
socket setting for the client-facing UDP socket (This rule action can be
specified multiple times with each rule action specifying another socket
setting)</li>
<li><code>socks5.onUdpAssociateRequest.peerFacingBindHost</code>: Specifies the binding
host name or address for the peer-facing UDP socket</li>
<li><code>socks5.onUdpAssociateRequest.peerFacingBindPortRange</code>: Specifies a
binding port range for the peer-facing UDP socket (This rule action can be
specified multiple times with each rule action specifying another port range)</li>
<li><code>socks5.onUdpAssociateRequest.peerFacingSocketSetting</code>: Specifies a socket
setting for the peer-facing UDP socket (This rule action can be specified
multiple times with each rule action specifying another socket setting)</li>
</ul>
<p>These rule actions can be used with the following rule conditions:</p>
<ul>

<li><code>clientAddress</code></li>
<li><code>socks5.method</code></li>
<li><code>socks5.request.command</code></li>
<li><code>socks5.request.desiredDestinationAddress</code></li>
<li><code>socks5.request.desiredDestinationPort</code></li>
<li><code>socks5.user</code></li>
<li><code>socksServerAddress</code></li>
</ul>
<p>The rule action <code>socks5.onBindRequest.inboundSocketSetting</code> can also be used with
the following rule conditions:</p>
<ul>

<li><code>socks5.reply.serverBoundAddress</code></li>
<li><code>socks5.reply.serverBoundPort</code></li>
</ul>
<p>API example:</p>

<div class="verbatim">
<pre><code class="language-java">package com.example;

import com.github.jh3nd3rs0n.jargyle.server.Configuration;
import com.github.jh3nd3rs0n.jargyle.server.Setting;
import com.github.jh3nd3rs0n.jargyle.server.Settings;
import com.github.jh3nd3rs0n.jargyle.server.SocksServer;

import java.io.IOException;

public class ServerApp {
    public static void main(String[] args) throws IOException {
        new SocksServer(Configuration.newUnmodifiableInstance(Settings.of(
            /*
             * Allow the CONNECT request to connect to 
             * 'specialserver.com' and configure the target-facing 
             * socket
             */
            Setting.newInstanceWithParsedValue(
                &quot;rule&quot;, 
                &quot;socks5.request.command=CONNECT,&quot;
                + &quot;socks5.request.desiredDestinationAddress=specialserver.com,&quot;
                + &quot;firewallAction=ALLOW,&quot;
                + &quot;socks5.onConnectRequest.prepareTargetFacingSocket=true,&quot;
                + &quot;socks5.onConnectRequest.targetFacingSocketSetting=SO_RCVBUF=256,&quot;
                + &quot;socks5.onConnectRequest.targetFacingSocketSetting=SO_SNDBUF=256&quot;),
            /*
             * Allow anything else
             */
            Setting.newInstanceWithParsedValue(
                &quot;rule&quot;, &quot;firewallAction=ALLOW&quot;)
        ))).start();
    }
}
</code></pre></div>
<p>Command line example:</p>

<div class="verbatim">
<pre><code class="language-bash">jargyle start-server \
    --setting=rule=socks5.request.command=CONNECT,socks5.request.desiredDestinationAddress=specialserver.com,firewallAction=ALLOW,socks5.onConnectRequest.prepareTargetFacingSocket=true,socks5.onConnectRequest.targetFacingSocketSetting=SO_RCVBUF=256,socks5.onConnectRequest.targetFacingSocketSetting=SO_SNDBUF=256 \
    --setting=rule=firewallAction=ALLOW
</code></pre></div>
<p>Server configuration file example:</p>

<div class="verbatim">
<pre><code class="language-xml">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot; standalone=&quot;yes&quot;?&gt;
&lt;configuration&gt;
    &lt;settings&gt;
        &lt;setting&gt;
            &lt;name&gt;rule&lt;/name&gt;
            &lt;rule&gt;
                &lt;ruleConditions&gt;
                    &lt;ruleCondition&gt;
                        &lt;name&gt;socks5.request.command&lt;/name&gt;
                        &lt;value&gt;CONNECT&lt;/value&gt;
                    &lt;/ruleCondition&gt;            
                    &lt;ruleCondition&gt;
                        &lt;name&gt;socks5.request.desiredDestinationAddress&lt;/name&gt;
                        &lt;value&gt;specialserver.com&lt;/value&gt;
                    &lt;/ruleCondition&gt;
                &lt;/ruleConditions&gt;
                &lt;ruleActions&gt;
                    &lt;ruleAction&gt;
                        &lt;name&gt;firewallAction&lt;/name&gt;
                        &lt;value&gt;ALLOW&lt;/value&gt;
                    &lt;/ruleAction&gt;
                    &lt;ruleAction&gt;
                        &lt;name&gt;socks5.onConnectRequest.prepareTargetFacingSocket&lt;/name&gt;
                        &lt;value&gt;true&lt;/value&gt;
                    &lt;/ruleAction&gt;
                    &lt;ruleAction&gt;
                        &lt;name&gt;socks5.onConnectRequest.targetFacingSocketSetting&lt;/name&gt;
                        &lt;socketSetting&gt;
                            &lt;name&gt;SO_RCVBUF&lt;/name&gt;
                            &lt;value&gt;256&lt;/value&gt;
                        &lt;/socketSetting&gt;
                    &lt;/ruleAction&gt;
                    &lt;ruleAction&gt;
                        &lt;name&gt;socks5.onConnectRequest.targetFacingSocketSetting&lt;/name&gt;
                        &lt;socketSetting&gt;
                            &lt;name&gt;SO_SNDBUF&lt;/name&gt;
                            &lt;value&gt;256&lt;/value&gt;
                        &lt;/socketSetting&gt;
                    &lt;/ruleAction&gt;
                &lt;/ruleActions&gt;
            &lt;/rule&gt;
        &lt;/setting&gt;
        &lt;setting&gt;
            &lt;name&gt;rule&lt;/name&gt;
            &lt;rule&gt;
                &lt;ruleConditions/&gt;
                &lt;ruleActions&gt;
                    &lt;ruleAction&gt;
                        &lt;name&gt;firewallAction&lt;/name&gt;
                        &lt;value&gt;ALLOW&lt;/value&gt;
                    &lt;/ruleAction&gt;
                &lt;/ruleActions&gt;
            &lt;/rule&gt;
        &lt;/setting&gt;
    &lt;/settings&gt;
&lt;/configuration&gt;
</code></pre></div></section><section>
<h3>Configuring Relay Settings</h3>
<p>To configure the relay settings, you will need any of the following rule actions:</p>
<ul>

<li><code>socks5.onBindRequest.relayBufferSize</code>: Specifies the buffer size in bytes
for relaying the data (Value must be an integer between 1 (inclusive) and
2147483647 (inclusive))</li>
<li><code>socks5.onBindRequest.relayIdleTimeout</code>: Specifies the timeout in
milliseconds on relaying no data (Value must be an integer between 1 (inclusive)
and 2147483647 (inclusive))</li>
<li><code>socks5.onConnectRequest.relayBufferSize</code>: Specifies the buffer size in bytes
for relaying the data (Value must be an integer between 1 (inclusive) and
2147483647 (inclusive))</li>
<li><code>socks5.onConnectRequest.relayIdleTimeout</code>: Specifies the timeout in
milliseconds on relaying no data (Value must be an integer between 1 (inclusive)
and 2147483647 (inclusive))</li>
<li><code>socks5.onRequest.relayBufferSize</code>: Specifies the buffer size in bytes
for relaying the data (Value must be an integer between 1 (inclusive) and
2147483647 (inclusive))</li>
<li><code>socks5.onRequest.relayIdleTimeout</code>: Specifies the timeout in
milliseconds on relaying no data (Value must be an integer between 1 (inclusive)
and 2147483647 (inclusive))</li>
<li><code>socks5.onUdpAssociateRequest.relayBufferSize</code>: Specifies the buffer size in
bytes for relaying the data (Value must be an integer between 1 (inclusive) and
2147483647 (inclusive))</li>
<li><code>socks5.onUdpAssociateRequest.relayIdleTimeout</code>: Specifies the timeout in
milliseconds on relaying no data (Value must be an integer between 1 (inclusive)
and 2147483647 (inclusive))</li>
</ul>
<p>These rule actions can be used with the following rule conditions:</p>
<ul>

<li><code>clientAddress</code></li>
<li><code>socks5.method</code></li>
<li><code>socks5.reply.serverBoundAddress</code></li>
<li><code>socks5.reply.serverBoundPort</code></li>
<li><code>socks5.request.command</code></li>
<li><code>socks5.request.desiredDestinationAddress</code></li>
<li><code>socks5.request.desiredDestinationPort</code></li>
<li><code>socks5.secondReply.serverBoundAddress</code></li>
<li><code>socks5.secondReply.serverBoundPort</code></li>
<li><code>socks5.user</code></li>
<li><code>socksServerAddress</code></li>
</ul>
<p>API example:</p>

<div class="verbatim">
<pre><code class="language-java">package com.example;

import com.github.jh3nd3rs0n.jargyle.server.Configuration;
import com.github.jh3nd3rs0n.jargyle.server.Setting;
import com.github.jh3nd3rs0n.jargyle.server.Settings;
import com.github.jh3nd3rs0n.jargyle.server.SocksServer;

import java.io.IOException;

public class ServerApp {
    public static void main(String[] args) throws IOException {
        new SocksServer(Configuration.newUnmodifiableInstance(Settings.of(
            /*
             * Allow the CONNECT request to connect to 
             * 'intermittent-idling-server.com' with a relay idle 
             * timeout of 1024000 milliseconds (1024 seconds)
             */
            Setting.newInstanceWithParsedValue(
                &quot;rule&quot;, 
                &quot;socks5.request.command=CONNECT,&quot;
                + &quot;socks5.request.desiredDestinationAddress=intermittent-idling-server.com,&quot;
                + &quot;firewallAction=ALLOW,&quot;
                + &quot;socks5.onConnectRequest.relayIdleTimeout=1024000&quot;),
            /*
             * Allow anything else
             */
            Setting.newInstanceWithParsedValue(
                &quot;rule&quot;, &quot;firewallAction=ALLOW&quot;)
        ))).start();
    }
}
</code></pre></div>
<p>Command line example:</p>

<div class="verbatim">
<pre><code class="language-bash">jargyle start-server \
    --setting=rule=socks5.request.command=CONNECT,socks5.request.desiredDestinationAddress=intermittent-idling-server.com,firewallAction=ALLOW,socks5.onConnectRequest.relayIdleTimeout=1024000 \
    --setting=rule=firewallAction=ALLOW
</code></pre></div>
<p>Server configuration file example:</p>

<div class="verbatim">
<pre><code class="language-xml">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot; standalone=&quot;yes&quot;?&gt;
&lt;configuration&gt;
    &lt;settings&gt;
        &lt;setting&gt;
            &lt;name&gt;rule&lt;/name&gt;
            &lt;rule&gt;
                &lt;ruleConditions&gt;
                    &lt;ruleCondition&gt;
                        &lt;name&gt;socks5.request.command&lt;/name&gt;
                        &lt;value&gt;CONNECT&lt;/value&gt;
                    &lt;/ruleCondition&gt;            
                    &lt;ruleCondition&gt;
                        &lt;name&gt;socks5.request.desiredDestinationAddress&lt;/name&gt;
                        &lt;value&gt;intermittent-idling-server.com&lt;/value&gt;
                    &lt;/ruleCondition&gt;
                &lt;/ruleConditions&gt;
                &lt;ruleActions&gt;
                    &lt;ruleAction&gt;
                        &lt;name&gt;firewallAction&lt;/name&gt;
                        &lt;value&gt;ALLOW&lt;/value&gt;
                    &lt;/ruleAction&gt;
                    &lt;ruleAction&gt;
                        &lt;name&gt;socks5.onConnectRequest.relayIdleTimeout&lt;/name&gt;
                        &lt;value&gt;1024000&lt;/value&gt;
                    &lt;/ruleAction&gt;
                &lt;/ruleActions&gt;
            &lt;/rule&gt;
        &lt;/setting&gt;
        &lt;setting&gt;
            &lt;name&gt;rule&lt;/name&gt;
            &lt;rule&gt;
                &lt;ruleConditions/&gt;
                &lt;ruleActions&gt;
                    &lt;ruleAction&gt;
                        &lt;name&gt;firewallAction&lt;/name&gt;
                        &lt;value&gt;ALLOW&lt;/value&gt;
                    &lt;/ruleAction&gt;
                &lt;/ruleActions&gt;
            &lt;/rule&gt;
        &lt;/setting&gt;    
    &lt;/settings&gt;
&lt;/configuration&gt;
</code></pre></div></section><section>
<h3>Limiting Relay Bandwidth</h3>
<p>To limit the relay bandwidth, you will need any of the following rule actions:</p>
<ul>

<li><code>socks5.onBindRequest.relayInboundBandwidthLimit</code>: Specifies the upper
limit on bandwidth in bytes per second of receiving inbound data to be relayed</li>
<li><code>socks5.onBindRequest.relayOutboundBandwidthLimit</code>: Specifies the upper
limit on bandwidth in bytes per second of receiving outbound data to be relayed</li>
<li><code>socks5.onConnectRequest.relayInboundBandwidthLimit</code>: Specifies the upper
limit on bandwidth in bytes per second of receiving inbound data to be relayed</li>
<li><code>socks5.onConnectRequest.relayOutboundBandwidthLimit</code>: Specifies the upper
limit on bandwidth in bytes per second of receiving outbound data to be relayed</li>
<li><code>socks5.onRequest.relayInboundBandwidthLimit</code>: Specifies the upper
limit on bandwidth in bytes per second of receiving inbound data to be relayed</li>
<li><code>socks5.onRequest.relayOutboundBandwidthLimit</code>: Specifies the upper
limit on bandwidth in bytes per second of receiving outbound data to be relayed</li>
<li><code>socks5.onUdpAssociateRequest.relayInboundBandwidthLimit</code>: Specifies the
upper limit on bandwidth in bytes per second of receiving inbound data to be
relayed</li>
<li><code>socks5.onUdpAssociateRequest.relayOutboundBandwidthLimit</code>: Specifies the
upper limit on bandwidth in bytes per second of receiving outbound data to be
relayed</li>
</ul>
<p>The value given to any of the rule actions must be an integer between 1
(inclusive) and 2147483647 (inclusive)</p>
<p>These rule actions can be used with the following rule conditions:</p>
<ul>

<li><code>clientAddress</code></li>
<li><code>socks5.method</code></li>
<li><code>socks5.reply.serverBoundAddress</code></li>
<li><code>socks5.reply.serverBoundPort</code></li>
<li><code>socks5.request.command</code></li>
<li><code>socks5.request.desiredDestinationAddress</code></li>
<li><code>socks5.request.desiredDestinationPort</code></li>
<li><code>socks5.secondReply.serverBoundAddress</code></li>
<li><code>socks5.secondReply.serverBoundPort</code></li>
<li><code>socks5.user</code></li>
<li><code>socksServerAddress</code></li>
</ul>
<p>API example:</p>

<div class="verbatim">
<pre><code class="language-java">package com.example;

import com.github.jh3nd3rs0n.jargyle.server.Configuration;
import com.github.jh3nd3rs0n.jargyle.server.Setting;
import com.github.jh3nd3rs0n.jargyle.server.Settings;
import com.github.jh3nd3rs0n.jargyle.server.SocksServer;

import java.io.IOException;

public class ServerApp {
    public static void main(String[] args) throws IOException {
        new SocksServer(Configuration.newUnmodifiableInstance(Settings.of(
            /*
             * Allow the CONNECT request to connect to 
             * 'streamingwebsite.com' with an upper limit on the 
             * relay inbound and outbound bandwidth of 1024000 
             * bytes per second
             */
            Setting.newInstanceWithParsedValue(
                &quot;rule&quot;, 
                &quot;socks5.request.command=CONNECT,&quot;
                + &quot;socks5.request.desiredDestinationAddress=streamingwebsite.com,&quot;
                + &quot;firewallAction=ALLOW,&quot;
                + &quot;socks5.onConnectRequest.relayInboundBandwidthLimit=1024000,&quot;
                + &quot;socks5.onConnectRequest.relayOutboundBandwidthLimit=1024000&quot;),
            /*
             * Allow anything else
             */
            Setting.newInstanceWithParsedValue(
                &quot;rule&quot;, &quot;firewallAction=ALLOW&quot;)
        ))).start();
    }
}
</code></pre></div>
<p>Command line example:</p>

<div class="verbatim">
<pre><code class="language-bash">jargyle start-server \
    --setting=rule=socks5.request.command=CONNECT,socks5.request.desiredDestinationAddress=streamingwebsite.com,firewallAction=ALLOW,socks5.onConnectRequest.relayInboundBandwidthLimit=1024000,socks5.onConnectRequest.relayOutboundBandwidthLimit=1024000 \
    --setting=rule=firewallAction=ALLOW
</code></pre></div>
<p>Server configuration file example:</p>

<div class="verbatim">
<pre><code class="language-xml">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot; standalone=&quot;yes&quot;?&gt;
&lt;configuration&gt;
    &lt;settings&gt;
        &lt;setting&gt;
            &lt;name&gt;rule&lt;/name&gt;
            &lt;rule&gt;
                &lt;ruleConditions&gt;
                    &lt;ruleCondition&gt;
                        &lt;name&gt;socks5.request.command&lt;/name&gt;
                        &lt;value&gt;CONNECT&lt;/value&gt;
                    &lt;/ruleCondition&gt;            
                    &lt;ruleCondition&gt;
                        &lt;name&gt;socks5.request.desiredDestinationAddress&lt;/name&gt;
                        &lt;value&gt;streamingwebsite.com&lt;/value&gt;
                    &lt;/ruleCondition&gt;
                &lt;/ruleConditions&gt;
                &lt;ruleActions&gt;
                    &lt;ruleAction&gt;
                        &lt;name&gt;firewallAction&lt;/name&gt;
                        &lt;value&gt;ALLOW&lt;/value&gt;
                    &lt;/ruleAction&gt;
                    &lt;ruleAction&gt;
                         &lt;name&gt;socks5.onConnectRequest.relayInboundBandwidthLimit&lt;/name&gt;
                        &lt;value&gt;1024000&lt;/value&gt;
                    &lt;/ruleAction&gt;
                    &lt;ruleAction&gt;
                         &lt;name&gt;socks5.onConnectRequest.relayOutboundBandwidthLimit&lt;/name&gt;
                        &lt;value&gt;1024000&lt;/value&gt;
                    &lt;/ruleAction&gt;                
                &lt;/ruleActions&gt;
            &lt;/rule&gt;
        &lt;/setting&gt;
        &lt;setting&gt;
            &lt;name&gt;rule&lt;/name&gt;
            &lt;rule&gt;
                &lt;ruleConditions/&gt;
                &lt;ruleActions&gt;
                    &lt;ruleAction&gt;
                        &lt;name&gt;firewallAction&lt;/name&gt;
                        &lt;value&gt;ALLOW&lt;/value&gt;
                    &lt;/ruleAction&gt;
                &lt;/ruleActions&gt;
            &lt;/rule&gt;
        &lt;/setting&gt;    
    &lt;/settings&gt;
&lt;/configuration&gt;
</code></pre></div></section></section></section>
        </main>
      </div>
    </div>
    <hr/>
    <footer>
      <div class="container-fluid">
        <div class="row-fluid">
            <p>Â©      2024
<a href="https://github.com/jh3nd3rs0n">jh3nd3rs0n</a>
</p>
        </div>
      </div>
    </footer>
<script>
  if(anchors) {
    anchors.add();
  }
</script>
  </body>
</html>
